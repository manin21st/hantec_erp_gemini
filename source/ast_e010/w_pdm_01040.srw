$PBExportHeader$w_pdm_01040.srw
$PBExportComments$** 거래처 등록
forward
global type w_pdm_01040 from window
end type
type pb_4 from picturebutton within w_pdm_01040
end type
type pb_3 from picturebutton within w_pdm_01040
end type
type pb_2 from picturebutton within w_pdm_01040
end type
type pb_1 from picturebutton within w_pdm_01040
end type
type p_inq from uo_picture within w_pdm_01040
end type
type p_exit from uo_picture within w_pdm_01040
end type
type p_can from uo_picture within w_pdm_01040
end type
type p_del from uo_picture within w_pdm_01040
end type
type p_mod from uo_picture within w_pdm_01040
end type
type cbx_auto from checkbox within w_pdm_01040
end type
type dw_main from datawindow within w_pdm_01040
end type
type dw_ip from datawindow within w_pdm_01040
end type
type rr_1 from roundrectangle within w_pdm_01040
end type
type rr_5 from roundrectangle within w_pdm_01040
end type
type rr_6 from roundrectangle within w_pdm_01040
end type
type tab_1 from tab within w_pdm_01040
end type
type tabpage_1 from userobject within tab_1
end type
type dw_17 from datawindow within tabpage_1
end type
type dw_1 from datawindow within tabpage_1
end type
type rr_2 from roundrectangle within tabpage_1
end type
type tabpage_1 from userobject within tab_1
dw_17 dw_17
dw_1 dw_1
rr_2 rr_2
end type
type tabpage_3 from userobject within tab_1
end type
type p_change from uo_picture within tabpage_3
end type
type p_add from uo_picture within tabpage_3
end type
type dw_3 from datawindow within tabpage_3
end type
type rr_3 from roundrectangle within tabpage_3
end type
type tabpage_3 from userobject within tab_1
p_change p_change
p_add p_add
dw_3 dw_3
rr_3 rr_3
end type
type tabpage_5 from userobject within tab_1
end type
type p_a5 from uo_picture within tabpage_5
end type
type dw_5 from datawindow within tabpage_5
end type
type rr_11 from roundrectangle within tabpage_5
end type
type tabpage_5 from userobject within tab_1
p_a5 p_a5
dw_5 dw_5
rr_11 rr_11
end type
type tabpage_7 from userobject within tab_1
end type
type p_5 from uo_picture within tabpage_7
end type
type p_7a from uo_picture within tabpage_7
end type
type dw_7 from datawindow within tabpage_7
end type
type rr_12 from roundrectangle within tabpage_7
end type
type tabpage_7 from userobject within tab_1
p_5 p_5
p_7a p_7a
dw_7 dw_7
rr_12 rr_12
end type
type tabpage_9 from userobject within tab_1
end type
type dw_9 from datawindow within tabpage_9
end type
type st_1 from statictext within tabpage_9
end type
type tabpage_9 from userobject within tab_1
dw_9 dw_9
st_1 st_1
end type
type tabpage_11 from userobject within tab_1
end type
type p_11b from uo_picture within tabpage_11
end type
type p_11a from uo_picture within tabpage_11
end type
type dw_11 from datawindow within tabpage_11
end type
type rr_14 from roundrectangle within tabpage_11
end type
type tabpage_11 from userobject within tab_1
p_11b p_11b
p_11a p_11a
dw_11 dw_11
rr_14 rr_14
end type
type tabpage_13 from userobject within tab_1
end type
type p_13b from uo_picture within tabpage_13
end type
type p_13a from uo_picture within tabpage_13
end type
type dw_13 from datawindow within tabpage_13
end type
type rr_15 from roundrectangle within tabpage_13
end type
type tabpage_13 from userobject within tab_1
p_13b p_13b
p_13a p_13a
dw_13 dw_13
rr_15 rr_15
end type
type tabpage_15 from userobject within tab_1
end type
type p_15b from uo_picture within tabpage_15
end type
type p_15a from uo_picture within tabpage_15
end type
type dw_15 from datawindow within tabpage_15
end type
type rr_16 from roundrectangle within tabpage_15
end type
type tabpage_15 from userobject within tab_1
p_15b p_15b
p_15a p_15a
dw_15 dw_15
rr_16 rr_16
end type
type tabpage_2 from userobject within tab_1
end type
type p_21 from uo_picture within tabpage_2
end type
type dw_21 from datawindow within tabpage_2
end type
type cb_21 from commandbutton within tabpage_2
end type
type dw_2 from datawindow within tabpage_2
end type
type rr_4 from roundrectangle within tabpage_2
end type
type tabpage_2 from userobject within tab_1
p_21 p_21
dw_21 dw_21
cb_21 cb_21
dw_2 dw_2
rr_4 rr_4
end type
type tabpage_4 from userobject within tab_1
end type
type p_4b from uo_picture within tabpage_4
end type
type p_4a from uo_picture within tabpage_4
end type
type dw_4 from datawindow within tabpage_4
end type
type rr_17 from roundrectangle within tabpage_4
end type
type tabpage_4 from userobject within tab_1
p_4b p_4b
p_4a p_4a
dw_4 dw_4
rr_17 rr_17
end type
type tabpage_6 from userobject within tab_1
end type
type p_6b from uo_picture within tabpage_6
end type
type p_6a from uo_picture within tabpage_6
end type
type dw_6 from datawindow within tabpage_6
end type
type rr_18 from roundrectangle within tabpage_6
end type
type tabpage_6 from userobject within tab_1
p_6b p_6b
p_6a p_6a
dw_6 dw_6
rr_18 rr_18
end type
type tabpage_8 from userobject within tab_1
end type
type p_8a from uo_picture within tabpage_8
end type
type dw_8 from datawindow within tabpage_8
end type
type rr_19 from roundrectangle within tabpage_8
end type
type tabpage_8 from userobject within tab_1
p_8a p_8a
dw_8 dw_8
rr_19 rr_19
end type
type tabpage_10 from userobject within tab_1
end type
type p_10b from uo_picture within tabpage_10
end type
type p_10a from uo_picture within tabpage_10
end type
type dw_10a from datawindow within tabpage_10
end type
type dw_10 from datawindow within tabpage_10
end type
type rr_7 from roundrectangle within tabpage_10
end type
type tabpage_10 from userobject within tab_1
p_10b p_10b
p_10a p_10a
dw_10a dw_10a
dw_10 dw_10
rr_7 rr_7
end type
type tabpage_12 from userobject within tab_1
end type
type p_12b from uo_picture within tabpage_12
end type
type p_12a from uo_picture within tabpage_12
end type
type dw_12 from datawindow within tabpage_12
end type
type rr_20 from roundrectangle within tabpage_12
end type
type tabpage_12 from userobject within tab_1
p_12b p_12b
p_12a p_12a
dw_12 dw_12
rr_20 rr_20
end type
type tabpage_14 from userobject within tab_1
end type
type p_14b from uo_picture within tabpage_14
end type
type p_14a from uo_picture within tabpage_14
end type
type dw_14 from datawindow within tabpage_14
end type
type rr_21 from roundrectangle within tabpage_14
end type
type tabpage_14 from userobject within tab_1
p_14b p_14b
p_14a p_14a
dw_14 dw_14
rr_21 rr_21
end type
type tabpage_16 from userobject within tab_1
end type
type p_16a from uo_picture within tabpage_16
end type
type dw_16 from datawindow within tabpage_16
end type
type rr_22 from roundrectangle within tabpage_16
end type
type tabpage_16 from userobject within tab_1
p_16a p_16a
dw_16 dw_16
rr_22 rr_22
end type
type tab_1 from tab within w_pdm_01040
tabpage_1 tabpage_1
tabpage_3 tabpage_3
tabpage_5 tabpage_5
tabpage_7 tabpage_7
tabpage_9 tabpage_9
tabpage_11 tabpage_11
tabpage_13 tabpage_13
tabpage_15 tabpage_15
tabpage_2 tabpage_2
tabpage_4 tabpage_4
tabpage_6 tabpage_6
tabpage_8 tabpage_8
tabpage_10 tabpage_10
tabpage_12 tabpage_12
tabpage_14 tabpage_14
tabpage_16 tabpage_16
end type
end forward

global type w_pdm_01040 from window
integer width = 4631
integer height = 2548
boolean titlebar = true
string title = "거래처 등록"
boolean controlmenu = true
boolean minbox = true
boolean maxbox = true
long backcolor = 32106727
pb_4 pb_4
pb_3 pb_3
pb_2 pb_2
pb_1 pb_1
p_inq p_inq
p_exit p_exit
p_can p_can
p_del p_del
p_mod p_mod
cbx_auto cbx_auto
dw_main dw_main
dw_ip dw_ip
rr_1 rr_1
rr_5 rr_5
rr_6 rr_6
tab_1 tab_1
end type
global w_pdm_01040 w_pdm_01040

type variables
char  ic_Status   // 1 => 등록모드, 2=> 수정모드

// 자료변경여부 검사
boolean  ib_any_typing

String     is_today              //시작일자
String     is_totime             //시작시간
String     is_window_id      //윈도우 ID
String     is_usegub           //이력관리 여부

String     is_auto           //자동채번 여부

str_customer  str_cust     //고객정보

end variables

forward prototypes
public function integer wf_warndataloss (string as_titletext)
public function integer wf_mult_custom (string as_gubun)
public function integer wf_cvcod_check (string scust)
public function integer wf_move ()
public function integer wf_maxcustcode ()
public subroutine wf_scroll (integer ii)
public subroutine wf_taborderzero ()
public function integer wf_confirm_key ()
public subroutine wf_taborder ()
public subroutine wf_new ()
public subroutine wf_query ()
end prototypes

public function integer wf_warndataloss (string as_titletext);/*=============================================================================================
		 1. window-level user function : 종료, 등록시 호출됨
		    dw_detail 의 typing(datawindow) 변경사항 검사

		 2. 계속진행할 경우 변경사항이 저장되지 않음을 경고                                                               

		 3. Argument:  as_titletext (warning messagebox)                                                                          
		    Return values:                                                   
                                                                  
      	*  1 : 변경사항을 저장하지 않고 계속 진행할 경우.
			* -1 : 진행을 중단할 경우.                      
=============================================================================================*/

IF ib_any_typing = true THEN  				// EditChanged event(dw_detail)의 typing 상태확인

	Beep(1)
	IF MessageBox("확인 : " + as_titletext , &
		 "저장하지 않은 값이 있습니다. ~r변경사항을 저장하시겠습니까", &
		 question!, yesno!) = 1 THEN

		dw_main.SetFocus()						// yes 일 경우: focus 'dw_detail' 
		RETURN -1									

	END IF

END IF
																
RETURN 1												// (dw_detail) 에 변경사항이 없거나 no일 경우
														// 변경사항을 저장하지 않고 계속진행 

end function

public function integer wf_mult_custom (string as_gubun);
string	sCode, sName, sGubun, sSaup, sInter

sCode = dw_main.getitemstring(1, "cvcod")
sName = dw_main.getitemstring(1, "cvnas")
sGubun= dw_main.getitemstring(1, "cvgu")
sSaup = dw_main.getitemstring(1, "sano")

CHOOSE CASE  sGubun
	CASE '1' TO  '2'
		sInter = '1'
	CASE '9'
		sInter = '99'
END CHOOSE

//IF sInter <> ''	THEN
//	IF f_Mult_Custom(sCode,sName,sInter,sSaup,'','','',as_Gubun) = -1	THEN	RETURN -1
//END IF

RETURN 1
end function

public function integer wf_cvcod_check (string scust);Long icnt = 0

select count(*) into :icnt
  from vnddan
 where cvcod = :scust;
if sqlca.sqlcode <> 0 or icnt >= 1 then
	f_message_chk(38,'[거래처제품단가]')
	return -1
end if

select count(*) into :icnt
  from vndsisang
 where cvcod = :scust;
if sqlca.sqlcode <> 0 or icnt >= 1 then
	f_message_chk(38,'[거래처평가시상]')
	return -1
end if

select count(*) into :icnt
  from vnddc
 where cvcod = :scust;
if sqlca.sqlcode <> 0 or icnt >= 1 then
	f_message_chk(38,'[거래처할인]')
	return -1
end if

select count(*) into :icnt
  from taxmisu
 where cvcod = :scust;
if sqlca.sqlcode <> 0 or icnt >= 1 then
	f_message_chk(38,'[계산서발행월미수]')
	return -1
end if

select count(*) into :icnt
  from danmst
 where cvcod = :scust;
if sqlca.sqlcode <> 0 or icnt >= 1 then
	f_message_chk(38,'[단가마스타]')
	return -1
end if

select count(*) into :icnt
  from estima
 where cvcod = :scust;
if sqlca.sqlcode <> 0 or icnt >= 1 then
	f_message_chk(38,'[발주예정_구매의뢰]')
	return -1
end if

select count(*) into :icnt
  from pomast
 where cvcod = :scust;
if sqlca.sqlcode <> 0 or icnt >= 1 then
	f_message_chk(38,'[발주일반정보]')
	return -1
end if

select count(*) into :icnt
  from sorder
 where cvcod = :scust;
if sqlca.sqlcode <> 0 or icnt >= 1 then
	f_message_chk(38,'[수주]')
	return -1
end if

select count(*) into :icnt
  from exppih
 where cvcod = :scust;
if sqlca.sqlcode <> 0 or icnt >= 1 then
	f_message_chk(38,'[수출PI Head]')
	return -1
end if

select count(*) into :icnt
  from imhist
 where cvcod = :scust;
if sqlca.sqlcode <> 0 or icnt >= 1 then
	f_message_chk(38,'[입출고이력]')
	return -1
end if

return 1
end function

public function integer wf_move ();//dw_1 데이타 move   	
tab_1.tabpage_1.dw_1.Accepttext()
dw_main.setitem(1,'cvgu', tab_1.tabpage_1.dw_1.getitemstring(1, 'cvgu'))     //거래처구분
dw_main.setitem(1,'saleyn', tab_1.tabpage_1.dw_1.getitemstring(1, 'saleyn')) //매출여부
dw_main.setitem(1,'gumaeyn', tab_1.tabpage_1.dw_1.getitemstring(1, 'gumaeyn')) //구매여부 
dw_main.setitem(1,'oyjuyn', tab_1.tabpage_1.dw_1.getitemstring(1, 'oyjuyn')) //외주여부
dw_main.setitem(1,'oyjugayn', tab_1.tabpage_1.dw_1.getitemstring(1, 'oyjugayn')) //외주가공 
dw_main.setitem(1,'yongyn', tab_1.tabpage_1.dw_1.getitemstring(1, 'yongyn')) //용역 
dw_main.setitem(1,'jongtype', tab_1.tabpage_1.dw_1.getitemstring(1, 'jongtype')) //업종분류
dw_main.setitem(1,'outgu', tab_1.tabpage_1.dw_1.getitemstring(1, 'outgu')) //매출처구분
dw_main.setitem(1,'deptcode', tab_1.tabpage_1.dw_1.getitemstring(1, 'deptcode')) //관리부서
dw_main.setitem(1,'emp_id', tab_1.tabpage_1.dw_1.getitemstring(1, 'emp_id')) //담당직원
dw_main.setitem(1,'visit_cicle', tab_1.tabpage_1.dw_1.getitemnumber(1, 'visit_cicle')) //방문주기
dw_main.setitem(1,'sarea', tab_1.tabpage_1.dw_1.getitemstring(1, 'sarea')) //관할구역
dw_main.setitem(1,'areacd', tab_1.tabpage_1.dw_1.getitemstring(1, 'areacd')) //지역
dw_main.setitem(1,'marketcode', tab_1.tabpage_1.dw_1.getitemstring(1, 'marketcode')) //시장
dw_main.setitem(1,'mlevel', tab_1.tabpage_1.dw_1.getitemstring(1, 'mlevel')) //관리등급
dw_main.setitem(1,'credit_limit', tab_1.tabpage_1.dw_1.getitemnumber(1, 'credit_limit')) //신용한도
dw_main.setitem(1,'rcvmg', tab_1.tabpage_1.dw_1.getitemstring(1, 'rcvmg')) //결제조건
dw_main.setitem(1,'tax_gu', tab_1.tabpage_1.dw_1.getitemstring(1, 'tax_gu')) //계산서발행
dw_main.setitem(1,'salescod', tab_1.tabpage_1.dw_1.getitemstring(1, 'salescod')) //실적거래처 
dw_main.setitem(1,'dcrategu', tab_1.tabpage_1.dw_1.getitemstring(1, 'dcrategu')) //할인율계산
dw_main.setitem(1,'itdcgu', tab_1.tabpage_1.dw_1.getitemstring(1, 'itdcgu')) //특별할인적용
dw_main.setitem(1,'cvbank', tab_1.tabpage_1.dw_1.getitemstring(1, 'cvbank')) //거래은행
dw_main.setitem(1,'cvdpno', tab_1.tabpage_1.dw_1.getitemstring(1, 'cvdpno')) //계좌번호
dw_main.setitem(1,'dpname', tab_1.tabpage_1.dw_1.getitemstring(1, 'dpname')) //예금주
dw_main.setitem(1,'exarea', tab_1.tabpage_1.dw_1.getitemstring(1, 'exarea')) //운송지역
dw_main.setitem(1,'exprice', tab_1.tabpage_1.dw_1.getitemnumber(1, 'exprice')) //구매일때에 구매 등급
dw_main.setitem(1,'pdate', tab_1.tabpage_1.dw_1.getitemstring(1, 'pdate')) //당사계약일
dw_main.setitem(1,'sdate', tab_1.tabpage_1.dw_1.getitemstring(1, 'sdate')) //거래시작일
dw_main.setitem(1,'edate', tab_1.tabpage_1.dw_1.getitemstring(1, 'edate')) //거래종료일
dw_main.setitem(1,'sale_emp', tab_1.tabpage_1.dw_1.getitemstring(1, 'sale_emp')) //영업담당자
dw_main.setitem(1,'sisang_ok', tab_1.tabpage_1.dw_1.getitemstring(1, 'sisang_ok')) //이자정산여부

dw_main.setitem(1,'pre_cvcod', tab_1.tabpage_1.dw_1.getitemstring(1, 'pre_cvcod')) //이전거래처
dw_main.setitem(1,'napqty', tab_1.tabpage_1.dw_1.getitemnumber(1, 'napqty')) //납품단위
dw_main.setitem(1,'gumgu', tab_1.tabpage_1.dw_1.getitemstring(1, 'gumgu')) //검수구분
dw_main.setitem(1,'outorder_dept', tab_1.tabpage_1.dw_1.getitemstring(1, 'outorder_dept')) //외주담당부서
dw_main.setitem(1,'outorder_emp', tab_1.tabpage_1.dw_1.getitemstring(1, 'outorder_emp')) //외주담당자

//dw_2 데이타 move   	
tab_1.tabpage_2.dw_2.Accepttext()
dw_main.setitem(1,'inwon', tab_1.tabpage_2.dw_2.getitemnumber(1, 'inwon')) //종업원수
dw_main.setitem(1,'totcr', tab_1.tabpage_2.dw_2.getitemnumber(1, 'totcr')) //총자산
dw_main.setitem(1,'cdate', tab_1.tabpage_2.dw_2.getitemstring(1, 'cdate')) //창업일자
dw_main.setitem(1,'totsales', tab_1.tabpage_2.dw_2.getitemnumber(1, 'totsales')) //년간 매출액
dw_main.setitem(1,'inmoney', tab_1.tabpage_2.dw_2.getitemnumber(1, 'inmoney')) //납입자본금
dw_main.setitem(1,'crdat', tab_1.tabpage_2.dw_2.getitemstring(1, 'crdat')) //영업개시일
dw_main.setitem(1,'benefit', tab_1.tabpage_2.dw_2.getitemnumber(1, 'benefit')) //년간순이익
dw_main.setitem(1,'ownmoney', tab_1.tabpage_2.dw_2.getitemnumber(1, 'ownmoney')) //자기자본
dw_main.setitem(1,'kdate', tab_1.tabpage_2.dw_2.getitemstring(1, 'kdate')) //결산일자
dw_main.setitem(1,'soyouja', tab_1.tabpage_2.dw_2.getitemstring(1, 'soyouja')) //소재지소유자
dw_main.setitem(1,'inguan', tab_1.tabpage_2.dw_2.getitemstring(1, 'inguan')) //임차관계
dw_main.setitem(1,'soguan', tab_1.tabpage_2.dw_2.getitemstring(1, 'soguan')) //소유자관계
dw_main.setitem(1,'dajigun', tab_1.tabpage_2.dw_2.getitemstring(1, 'dajigun')) //대지건물
dw_main.setitem(1,'suljung', tab_1.tabpage_2.dw_2.getitemstring(1, 'suljung')) //설정내용
dw_main.setitem(1,'ipjogun', tab_1.tabpage_2.dw_2.getitemstring(1, 'ipjogun')) //입지조건
dw_main.setitem(1,'gadong', tab_1.tabpage_2.dw_2.getitemstring(1, 'gadong')) //가동현황
dw_main.setitem(1,'sangsan', tab_1.tabpage_2.dw_2.getitemstring(1, 'sangsan')) //생산방식
dw_main.setitem(1,'juprod', tab_1.tabpage_2.dw_2.getitemstring(1, 'juprod')) //생산품목
dw_main.setitem(1,'juhandle', tab_1.tabpage_2.dw_2.getitemstring(1, 'juhandle')) //취급품목
dw_main.setitem(1,'jumaeip', tab_1.tabpage_2.dw_2.getitemstring(1, 'jumaeip')) //매입처
dw_main.setitem(1,'jumaechul', tab_1.tabpage_2.dw_2.getitemstring(1, 'jumaechul')) //매출처
dw_main.setitem(1,'rewapunish', tab_1.tabpage_2.dw_2.getitemstring(1, 'rewapunish')) //상벌사항

//dw_9 데이타(경영철학) move   	
tab_1.tabpage_9.dw_9.Accepttext()
dw_main.setitem(1,'kyungy', tab_1.tabpage_9.dw_9.getitemstring(1, 'kyungy')) //경영이념
dw_main.setitem(1,'gibonbang', tab_1.tabpage_9.dw_9.getitemstring(1, 'gibonbang')) //기본방침
dw_main.setitem(1,'hugyuja', tab_1.tabpage_9.dw_9.getitemstring(1, 'hugyuja')) //후계자문제

//dw_10 데이타(경영목표) move   	
tab_1.tabpage_10.dw_10.Accepttext()
dw_main.setitem(1,'jangmock', tab_1.tabpage_10.dw_10.getitemstring(1, 'jangmock')) //장기목표
dw_main.setitem(1,'jungmock', tab_1.tabpage_10.dw_10.getitemstring(1, 'jungmock')) //중기목표
dw_main.setitem(1,'danmock', tab_1.tabpage_10.dw_10.getitemstring(1, 'danmock')) //단기목표

return 1
end function

public function integer wf_maxcustcode ();//////////////////////////////////////////////////////////////
// 	1. 거래처구분 -> 거래처코드 자동채번 
//		2. 국내,해외,기타거래처만 자동채번 (창고,부서,은행은 제외)
//       단 기타거래처에서 999999는 자동채번에서 제외
//////////////////////////////////////////////////////////////
String 	sGubunCode,		&
			sFetched_Id = '', sext_code
real		rMaxCode

sGubunCode = tab_1.tabpage_1.dw_1.GetItemString(1, "cvgu")					

IF sGubunCode = '1'THEN

	SELECT Max("VNDMST"."CVCOD")
     INTO :sFetched_Id
     FROM "VNDMST"  
    WHERE "VNDMST"."CVGU" = :sGubunCode 
	 AND   SUBSTR("VNDMST"."CVCOD", 1, 1)  = :sGubunCode;
	
	IF IsNull(sFetched_Id) or  sFetched_id = ''   THEN
		sFetched_Id = sGubunCode + "00001"
	ELSE
		DO 
//			SELECT "VNDMST"."CVCOD"
//   		  INTO :sext_code
//			  FROM "VNDMST"  
//	   	 WHERE "VNDMST"."CVCOD" = :sFetched_Id

			SELECT CVCOD 
  		   INTO :sext_code
			FROM (
			SELECT CVCOD
			FROM VNDMST  
			Union
			SELECT PERSON_CD CVCOD
			FROM	KFZ04OM0_GYUL )
			WHERE CVCOD = :sFetched_Id;
			
			IF SQLCA.SQLCODE = 0 THEN
				sFetched_Id = String(real(sFetched_id) + 1)
			END IF
			
		LOOP UNTIL SQLCA.SQLCODE = 100
	END IF
	
	rMaxCode = real(sFetched_id) 
	
	IF rMaxCode >= 1 AND len(string(rmaxcode)) = 6 AND string(rmaxcode) <> '999999' THEN
		dw_main.SetItem(1, "cvcod" , string(rMaxCode) )
		dw_ip.SetItem(1, "vndcod" , string(rMaxCode) )
	ELSE
		MessageBox("거래처구분 확인", "거래처코드를 채번할 수 없습니다.")
		dw_ip.SetFocus()
		RETURN -1
	END IF

ELSEIF sGubunCode = '2' Then

	SELECT Max("VNDMST"."CVCOD")
     INTO :sFetched_Id
     FROM "VNDMST"  
    WHERE "VNDMST"."CVGU" = :sGubunCode 
	 AND   SUBSTR("VNDMST"."CVCOD", 1, 1)  = :sGubunCode;


	IF IsNull(sFetched_Id) or  sFetched_id = ''   THEN
		sFetched_Id = sGubunCode + "00001"
	ELSE
		DO 
			SELECT CVCOD 
  		   INTO :sext_code
			FROM (
			SELECT CVCOD
			FROM VNDMST  
			Union
			SELECT PERSON_CD CVCOD
			FROM	KFZ04OM0_GYUL )
			WHERE CVCOD = :sFetched_Id;

			IF SQLCA.SQLCODE = 0 THEN
				sFetched_Id = String(real(sFetched_id) + 1)
			END IF
			
		LOOP UNTIL SQLCA.SQLCODE = 100
	END IF
	
	rMaxCode = real(sFetched_id) 
	
	IF rMaxCode >= 1 AND len(string(rmaxcode)) = 6 AND string(rmaxcode) <> '999999' THEN
		dw_main.SetItem(1, "cvcod" , string(rMaxCode) )
		dw_ip.SetItem(1, "vndcod" , string(rMaxCode) )
	ELSE
		MessageBox("거래처구분 확인", "거래처코드를 채번할 수 없습니다.")
		dw_ip.SetFocus()
		RETURN -1
	END IF

ELSEIF sGubunCode = '9'	THEN

	SELECT Max("VNDMST"."CVCOD")
     INTO :sFetched_Id
     FROM "VNDMST"  
    WHERE "VNDMST"."CVGU" = :sGubunCode AND 
	       SUBSTR("VNDMST"."CVCOD", 1, 1)  = :sGubunCode AND
          "VNDMST"."CVCOD" <> '999999'   ;
	
	IF IsNull(sFetched_Id) or  sFetched_id = ''   THEN
		sFetched_Id = sGubunCode + "00000"
	ELSE
		DO 
			SELECT CVCOD 
  		   INTO :sext_code
			FROM (
			SELECT CVCOD
			FROM VNDMST  
			Union
			SELECT PERSON_CD CVCOD
			FROM	KFZ04OM0_GYUL )
			WHERE CVCOD = :sFetched_Id;

			IF SQLCA.SQLCODE = 0 THEN
				sFetched_Id = String(real(sFetched_id) + 1)
			END IF
			
		LOOP UNTIL SQLCA.SQLCODE = 100
	END IF
	
	rMaxCode = real(sFetched_id) 
	
	IF rMaxCode >= 1 AND len(string(rmaxcode)) = 6 AND string(rmaxcode) <> '999999' THEN
		dw_main.SetItem(1, "cvcod" , string(rMaxCode) )
		dw_ip.SetItem(1, "vndcod" , string(rMaxCode) )
	ELSE
		MessageBox("거래처구분 확인", "거래처코드를 채번할 수 없습니다.")
		dw_ip.SetFocus()
		RETURN -1
	END IF
Else
	MessageBox("자동채번 확인", "거래처구분이 자동 채번 대상이 아닙니다.~r~r자동채번을 여부를 해제하세요")
	Return -1
END IF
	
RETURN	1

end function

public subroutine wf_scroll (integer ii);string scod, srcod

dw_ip.accepttext()
scod = dw_ip.getitemstring(1, "vndcod")

setnull(srcod)

choose case ii
		 case 1  //First page
				Select Min(cvcod) into :srcod From vndmst;
		 case 2  //Prior page
				Select Max(cvcod) into :srcod From vndmst Where cvcod < :scod;
		 case 3  //Next  page
				Select Min(cvcod) into :srcod From vndmst Where cvcod > :scod;				
		 case 4  //Last  page
				Select Max(cvcod) into :srcod From vndmst;				
End choose
dw_ip.setitem(1, "vndcod", srcod)
//dw_ip.setitem(1, "custno", srcod)
p_inq.TriggerEvent(Clicked!)
end subroutine

public subroutine wf_taborderzero ();dw_ip.SetTabOrder('vndcod', 0)
dw_ip.SetTabOrder('custno', 0)
//dw_ip.Modify("vndcod.BackGround.Color= 79741120") 
//dw_ip.Modify("custno.BackGround.Color= 79741120") 


end subroutine

public function integer wf_confirm_key ();/*=====================================================================
		1.	등록 mode : Key 검색
		2. Argument : None
		3.	Return Value
			- ( -1 ) : 등록된 코드 
			- (  1 ) : 신  규 코드
=====================================================================*/

string	sGubun,sname1,sname2,is_key1, snull, saup_no, sownam, sArea
int      i

SetNull(snull)
if dw_ip.AcceptText() = -1 then return -1
if dw_main.AcceptText() = -1 then return -1
if tab_1.tabpage_1.dw_1.AcceptText() = -1 then return -1

is_Key1 = dw_ip.GetItemString(1, "vndcod")
sname1  = dw_main.GetItemString(1, "cvnas")
sname2  = dw_main.GetItemString(1, "cvnas2")
saup_no  = trim(dw_main.GetItemString(1, "sano"))
sownam    = trim(dw_main.GetItemString(1, "ownam"))
sGubun  = tab_1.tabpage_1.dw_1.GetItemString(1, "cvgu")
sArea  = tab_1.tabpage_1.dw_1.GetItemString(1, "sarea")

IF is_auto = 'N' THEN
	IF (is_key1 = "" or isnull(is_key1)) THEN
		f_message_chk(30,'[거래처코드]')
		dw_ip.SetItem(1,"vndcod",snull)
		dw_ip.setcolumn("vndcod")
		dw_ip.SetFocus()
		Return -1
	END IF
ELSE
	IF cbx_auto.Checked = FALSE AND (is_key1 = "" or isnull(is_key1)) THEN
		f_message_chk(30,'[거래처코드]')
		dw_ip.SetItem(1,"vndcod",snull)
		dw_ip.setcolumn("vndcod")
		dw_ip.SetFocus()
		Return -1
	END IF
END IF

IF sname1 ="" OR IsNull(sname1) THEN
	f_message_chk(30,'[상호]')
	dw_main.SetItem(1,"cvnas",snull)
	dw_main.setcolumn("cvnas")
	dw_main.SetFocus()
	Return -1
END IF

IF sname2 ="" OR IsNull(sname2) THEN
	f_message_chk(30,'[약식상호]')
	dw_main.SetItem(1,"cvnas2",snull)
	dw_main.setcolumn("cvnas2")
	dw_main.SetFocus()
	Return -1
END IF

IF sGubun ="" OR IsNull(sGubun) THEN
	f_message_chk(30,'[거래처구분]')
   tab_1.SelectTab(1)
	tab_1.tabpage_1.dw_1.SetItem(1,"cvgu",snull)
	tab_1.tabpage_1.dw_1.setcolumn("cvgu")
	tab_1.tabpage_1.dw_1.SetFocus()
	Return -1
END IF

IF sGubun = '1' THEN 
	IF saup_no ="" OR IsNull(saup_no) THEN
		f_message_chk(30,'[사업자 번호]')
		dw_main.SetItem(1,"sano",snull)
		dw_main.setcolumn("sano")
		dw_main.SetFocus()
		Return -1
	END IF
	
	IF sownam ="" OR IsNull(sownam) THEN
		f_message_chk(30,'[대표자]')
		dw_main.SetItem(1,"ownam",snull)
		dw_main.setcolumn("ownam")
		dw_main.SetFocus()
		Return -1
	END IF
END IF

IF sarea ="" OR IsNull(sarea) THEN
	f_message_chk(30,'[관할구역]')
   tab_1.SelectTab(1)
	tab_1.tabpage_1.dw_1.setcolumn("sarea")
	tab_1.tabpage_1.dw_1.SetFocus()
	Return -1
END IF

//차입금 필수입력 체크
if tab_1.tabpage_4.dw_4.AcceptText() = -1 then return -1

FOR i=1 TO tab_1.tabpage_4.dw_4.rowcount()
	if isnull(tab_1.tabpage_4.dw_4.GetItemNumber(i,'seq')) or &
		tab_1.tabpage_4.dw_4.GetItemNumber(i,'seq') = 0 then
		f_message_chk(1400,'[ '+string(i)+' 행 차입금 순번]')
      tab_1.SelectTab(10)
		tab_1.tabpage_4.dw_4.ScrollToRow(i)
		tab_1.tabpage_4.dw_4.SetColumn('seq')
		tab_1.tabpage_4.dw_4.SetFocus()
		return -1		
	end if	
NEXT

//주주명부 필수입력 체크
if tab_1.tabpage_6.dw_6.AcceptText() = -1 then return -1

FOR i=1 TO tab_1.tabpage_6.dw_6.rowcount()
	if isnull(tab_1.tabpage_6.dw_6.GetItemNumber(i,'seq')) or &
		tab_1.tabpage_6.dw_6.GetItemNumber(i,'seq') = 0 then
		f_message_chk(1400,'[ '+string(i)+' 행 주주명부 순번]')
      tab_1.SelectTab(11)
		tab_1.tabpage_6.dw_6.ScrollToRow(i)
		tab_1.tabpage_6.dw_6.SetColumn('seq')
		tab_1.tabpage_6.dw_6.SetFocus()
		return -1		
	end if	
NEXT

//비중도 필수입력 체크
if tab_1.tabpage_7.dw_7.AcceptText() = -1 then return -1

FOR i=1 TO tab_1.tabpage_7.dw_7.rowcount()
	if isnull(trim(tab_1.tabpage_7.dw_7.GetItemString(i,'yyyymm'))) or &
		trim(tab_1.tabpage_7.dw_7.GetItemString(i,'yyyymm')) = "" then
		f_message_chk(1400,'[ '+string(i)+' 행 비중도 년월]')
      tab_1.SelectTab(4)
		tab_1.tabpage_7.dw_7.ScrollToRow(i)
		tab_1.tabpage_7.dw_7.SetColumn('yyyymm')
		tab_1.tabpage_7.dw_7.SetFocus()
		return -1		
	end if	
NEXT

//경영목표 필수입력 체크
if tab_1.tabpage_10.dw_10a.AcceptText() = -1 then return -1

FOR i=1 TO tab_1.tabpage_10.dw_10a.rowcount()
	if isnull(trim(tab_1.tabpage_10.dw_10a.GetItemString(i,'mtgyear'))) or &
		trim(tab_1.tabpage_10.dw_10a.GetItemString(i,'mtgyear')) = "" then
		f_message_chk(1400,'[ '+string(i)+' 행 경영목표 년도]')
      tab_1.SelectTab(13)
		tab_1.tabpage_10.dw_10a.ScrollToRow(i)
		tab_1.tabpage_10.dw_10a.SetColumn('mtgyear')
		tab_1.tabpage_10.dw_10a.SetFocus()
		return -1		
	end if	
NEXT

//매출예상 필수입력 체크
if tab_1.tabpage_11.dw_11.AcceptText() = -1 then return -1

FOR i=1 TO tab_1.tabpage_11.dw_11.rowcount()
	if isnull(trim(tab_1.tabpage_11.dw_11.GetItemString(i,'mcyear'))) or &
		trim(tab_1.tabpage_11.dw_11.GetItemString(i,'mcyear')) = "" then
		f_message_chk(1400,'[ '+string(i)+' 행 매출예상 년도]')
      tab_1.SelectTab(6)
		tab_1.tabpage_11.dw_11.ScrollToRow(i)
		tab_1.tabpage_11.dw_11.SetColumn('mcyear')
		tab_1.tabpage_11.dw_11.SetFocus()
		return -1		
	end if	
NEXT

//주변의견 필수입력 체크
if tab_1.tabpage_12.dw_12.AcceptText() = -1 then return -1

FOR i=1 TO tab_1.tabpage_12.dw_12.rowcount()
	if isnull(trim(tab_1.tabpage_12.dw_12.GetItemString(i,'acdate'))) or &
		trim(tab_1.tabpage_12.dw_12.GetItemString(i,'acdate')) = "" then
		f_message_chk(1400,'[ '+string(i)+' 행 정보접수일]')
      tab_1.SelectTab(14)
		tab_1.tabpage_12.dw_12.ScrollToRow(i)
		tab_1.tabpage_12.dw_12.SetColumn('acdate')
		tab_1.tabpage_12.dw_12.SetFocus()
		return -1		
	end if	
NEXT

//평가도 필수입력 체크
if tab_1.tabpage_13.dw_13.AcceptText() = -1 then return -1

FOR i=1 TO tab_1.tabpage_13.dw_13.rowcount()
	if isnull(trim(tab_1.tabpage_13.dw_13.GetItemString(i,'pdate'))) or &
		trim(tab_1.tabpage_13.dw_13.GetItemString(i,'pdate')) = "" then
		f_message_chk(1400,'[ '+string(i)+' 행 평가일]')
      tab_1.SelectTab(7)
		tab_1.tabpage_13.dw_13.ScrollToRow(i)
		tab_1.tabpage_13.dw_13.SetColumn('pdate')
		tab_1.tabpage_13.dw_13.SetFocus()
		return -1		
	end if	
NEXT

//종합평가 필수입력 체크
if tab_1.tabpage_14.dw_14.AcceptText() = -1 then return -1

FOR i=1 TO tab_1.tabpage_14.dw_14.rowcount()
	if isnull(trim(tab_1.tabpage_14.dw_14.GetItemString(i,'tdate'))) or &
		trim(tab_1.tabpage_14.dw_14.GetItemString(i,'tdate')) = "" then
		f_message_chk(1400,'[ '+string(i)+' 행 종합평가일]')
      tab_1.SelectTab(15)
		tab_1.tabpage_14.dw_14.ScrollToRow(i)
		tab_1.tabpage_14.dw_14.SetColumn('tdate')
		tab_1.tabpage_14.dw_14.SetFocus()
		return -1		
	end if	
NEXT

//특기사항 필수입력 체크
if tab_1.tabpage_15.dw_15.AcceptText() = -1 then return -1

FOR i=1 TO tab_1.tabpage_15.dw_15.rowcount()
	if isnull(trim(tab_1.tabpage_15.dw_15.GetItemString(i,'specialdate'))) or &
		trim(tab_1.tabpage_15.dw_15.GetItemString(i,'specialdate')) = "" then
		f_message_chk(1400,'[ '+string(i)+' 행 접수일자]')
      tab_1.SelectTab(8)
		tab_1.tabpage_15.dw_15.ScrollToRow(i)
		tab_1.tabpage_15.dw_15.SetColumn('specialdate')
		tab_1.tabpage_15.dw_15.SetFocus()
		return -1		
	end if	
NEXT

Return 1

end function

public subroutine wf_taborder ();dw_ip.SetTabOrder('vndcod', 10)
//dw_ip.SetTabOrder('custno', 20)
//dw_ip.Modify("vndcod.BackGround.Color= 65535") 
//dw_ip.Modify("custno.BackGround.Color= 65535") 

dw_main.SetColumn('cvnas')



end subroutine

public subroutine wf_new ();String arcd

select min(sarea) into :arcd from sarea;

ic_status = '1'
w_mdi_frame.sle_msg.text = "등록"

///////////////////////////////////////////////
dw_ip.setredraw(false)
dw_main.setredraw(false)
tab_1.tabpage_1.setredraw(false)

dw_ip.reset()
dw_ip.insertrow(0)

dw_main.reset()
dw_main.InsertRow(0)

dw_main.Enabled =True

tab_1.tabpage_1.dw_1.reset()
tab_1.tabpage_1.dw_1.InsertRow(0)
tab_1.tabpage_1.dw_1.Enabled =True
tab_1.tabpage_1.dw_1.setitem(1, 'cvgu', '1')
tab_1.tabpage_1.dw_1.setitem(1, 'sarea', arcd)
tab_1.tabpage_1.dw_17.reset()
tab_1.tabpage_1.dw_17.InsertRow(0)

tab_1.tabpage_2.dw_2.reset()
tab_1.tabpage_2.dw_2.InsertRow(0)

tab_1.tabpage_3.dw_3.reset()
tab_1.tabpage_4.dw_4.reset()
tab_1.tabpage_5.dw_5.reset()
tab_1.tabpage_6.dw_6.reset()
tab_1.tabpage_7.dw_7.reset()
tab_1.tabpage_8.dw_8.reset()

tab_1.tabpage_9.dw_9.reset()
tab_1.tabpage_9.dw_9.InsertRow(0)

tab_1.tabpage_10.dw_10.reset()
tab_1.tabpage_10.dw_10.InsertRow(0)
tab_1.tabpage_10.dw_10a.reset()

tab_1.tabpage_11.dw_11.reset()
tab_1.tabpage_12.dw_12.reset()
tab_1.tabpage_13.dw_13.reset()
tab_1.tabpage_14.dw_14.reset()
tab_1.tabpage_15.dw_15.reset()
tab_1.tabpage_16.dw_16.reset()

tab_1.SelectTab(1)
tab_1.tabpage_2.enabled = false
tab_1.tabpage_3.enabled = false
tab_1.tabpage_4.enabled = false
tab_1.tabpage_5.enabled = false
tab_1.tabpage_6.enabled = false
tab_1.tabpage_7.enabled = false
tab_1.tabpage_8.enabled = false
tab_1.tabpage_9.enabled = false
tab_1.tabpage_10.enabled = false
tab_1.tabpage_11.enabled = false
tab_1.tabpage_12.enabled = false
tab_1.tabpage_13.enabled = false
tab_1.tabpage_14.enabled = false
tab_1.tabpage_15.enabled = false
tab_1.tabpage_16.enabled = false

wf_TabOrder()

dw_ip.SetFocus()

dw_ip.setredraw(true)
dw_main.setredraw(true)
tab_1.tabpage_1.setredraw(true)
///////////////////////////////////////////////

p_del.enabled = false
p_del.PictureName = 'C:\erpman\image\삭제_d.gif'
p_mod.Enabled =True
p_mod.PictureName = 'C:\erpman\image\저장_up.gif'

ib_any_typing = false

end subroutine

public subroutine wf_query ();string scvgu, scode1

w_mdi_frame.sle_msg.text = "조회"

ic_Status = '2'

wf_TabOrderZero()

//dw_main.settaborder("cvnas",  0)
//dw_main.settaborder("cvnas2",  0)
//dw_main.settaborder("sano",  0)
//dw_main.settaborder("ownam",  0)
//
//dw_main.Object.cvnas.Background.Color= 79741120
//dw_main.Object.cvnas2.Background.Color= 79741120
//dw_main.Object.sano.Background.Color= 79741120
//dw_main.Object.ownam.Background.Color= 79741120
//
dw_ip.AcceptText()

scode1 = dw_ip.getitemstring(1, 'vndcod')

tab_1.tabpage_1.dw_1.Retrieve(sCode1) 
If tab_1.tabpage_1.dw_17.Retrieve(sCode1) <= 0 Then
	tab_1.tabpage_1.dw_17.Reset()
	tab_1.tabpage_1.dw_17.InsertRow(0)
End If
tab_1.tabpage_2.dw_2.Retrieve(sCode1) 
tab_1.tabpage_2.dw_21.Retrieve(sCode1) 
tab_1.tabpage_3.dw_3.Retrieve(sCode1) 
tab_1.tabpage_4.dw_4.Retrieve(sCode1) 
tab_1.tabpage_5.dw_5.Retrieve(sCode1) 
tab_1.tabpage_6.dw_6.Retrieve(sCode1) 
tab_1.tabpage_7.dw_7.Retrieve(sCode1) 
tab_1.tabpage_8.dw_8.Retrieve(sCode1) 
tab_1.tabpage_9.dw_9.Retrieve(sCode1) 
tab_1.tabpage_10.dw_10.Retrieve(sCode1) 
tab_1.tabpage_10.dw_10a.Retrieve(sCode1) 
tab_1.tabpage_11.dw_11.Retrieve(sCode1) 
tab_1.tabpage_12.dw_12.Retrieve(sCode1) 
tab_1.tabpage_13.dw_13.Retrieve(sCode1) 
tab_1.tabpage_14.dw_14.Retrieve(sCode1) 
tab_1.tabpage_15.dw_15.Retrieve(sCode1) 
tab_1.tabpage_16.dw_16.Retrieve(sCode1) 

tab_1.tabpage_1.dw_1.AcceptText()

scvgu = tab_1.tabpage_1.dw_1.getitemstring(1, 'cvgu')

if scvgu = '4' or scvgu = '5' then
//if scvgu  = '3' or scvgu = '4' or scvgu = '5' then   //은행3, 부서4, 창고5일때 조회만 
	dw_main.enabled = false
	tab_1.SelectTab(1)
	tab_1.tabpage_1.dw_1.enabled = false
	tab_1.tabpage_2.enabled = false
	tab_1.tabpage_3.enabled = false
	tab_1.tabpage_4.enabled = false
	tab_1.tabpage_5.enabled = false
	tab_1.tabpage_6.enabled = false
	tab_1.tabpage_7.enabled = false
	tab_1.tabpage_8.enabled = false
	tab_1.tabpage_9.enabled = false
	tab_1.tabpage_10.enabled = false
	tab_1.tabpage_11.enabled = false
	tab_1.tabpage_12.enabled = false
	tab_1.tabpage_13.enabled = false
	tab_1.tabpage_14.enabled = false
	tab_1.tabpage_15.enabled = false
	tab_1.tabpage_16.enabled = false
   p_del.enabled = false
	p_del.PictureName = 'C:\erpman\image\삭제_d.gif'
   p_mod.Enabled = false
	p_mod.PictureName = 'C:\erpman\image\저장_d.gif'
else
	tab_1.SelectTab(1)
   p_del.enabled = True
	p_del.PictureName = 'C:\erpman\image\삭제_up.gif'
   p_mod.Enabled = True
	p_mod.PictureName = 'C:\erpman\image\저장_up.gif'
	dw_main.enabled = True
	tab_1.tabpage_1.dw_1.enabled = true
	tab_1.tabpage_2.enabled = true
	tab_1.tabpage_3.enabled = true
	tab_1.tabpage_4.enabled = true
	tab_1.tabpage_5.enabled = true
	tab_1.tabpage_6.enabled = true
	tab_1.tabpage_7.enabled = true
	tab_1.tabpage_8.enabled = true
	tab_1.tabpage_9.enabled = true
	tab_1.tabpage_10.enabled = true
	tab_1.tabpage_11.enabled = true
	tab_1.tabpage_12.enabled = true
	tab_1.tabpage_13.enabled = true
	tab_1.tabpage_14.enabled = true
	tab_1.tabpage_15.enabled = true
	tab_1.tabpage_16.enabled = true
end if

dw_main.SetFocus()

end subroutine

event open;Integer  li_idx

li_idx = w_mdi_frame.dw_listbar.InsertRow(0)
w_mdi_frame.dw_listbar.SetItem(li_idx,'window_id',Upper(This.ClassName()))
w_mdi_frame.dw_listbar.SetItem(li_idx,'window_name',Upper(This.Title))
w_mdi_frame.Postevent("ue_barrefresh")

is_today = f_today()
is_totime = f_totime()
is_window_id = this.ClassName()

w_mdi_frame.st_window.Text = Upper(is_window_id)

SELECT "SUB2_T"."OPEN_HISTORY"  
  INTO :is_usegub 
  FROM "SUB2_T"  
 WHERE "SUB2_T"."WINDOW_NAME" = :is_window_id   ;

IF is_usegub = 'Y' THEN
   INSERT INTO "PGM_HISTORY"  
	 		 ( "L_USERID",   "CDATE",       "STIME",      "WINDOW_NAME",   "EDATE",   
			   "ETIME",      "IPADD",       "USER_NAME" )  
   VALUES ( :gs_userid,   :is_today,     :is_totime,   :is_window_id,   NULL, 
	   		NULL,         :gs_ipaddress, :gs_comname )  ;

   IF SQLCA.SQLCODE = 0 THEN 
	   COMMIT;
   ELSE 	  
	   ROLLBACK;
   END IF	 
END IF	  

dw_ip.settransobject(sqlca)
dw_main.settransobject(sqlca)

DataWindowChild state_child, state_child1
integer rtncode



// 구매담당자
F_CHILD_SAUPJ(tab_1.tabpage_1.dw_1, 'emp_id', gs_saupj)
//rtncode = tab_1.tabpage_1.dw_1.GetChild('emp_id', state_child)
//IF rtncode = -1 THEN MessageBox("Error", "Not a DataWindowChild - 구매")
//state_child.SetTransObject(SQLCA)
//state_child.Retrieve("1", "1", gs_saupj)

// 외주담당자
F_CHILD_SAUPJ(tab_1.tabpage_1.dw_1, 'outorder_emp', gs_saupj)
//rtncode = tab_1.tabpage_1.dw_1.GetChild('outorder_emp', state_child1)
//IF rtncode = -1 THEN MessageBox("Error", "Not a DataWindowChild - 외주")
//state_child1.SetTransObject(SQLCA)
//state_child1.Retrieve("2", "2", gs_saupj)


tab_1.tabpage_1.dw_1.settransobject(sqlca)
tab_1.tabpage_1.dw_17.settransobject(sqlca)
tab_1.tabpage_2.dw_2.settransobject(sqlca)
tab_1.tabpage_2.dw_21.settransobject(sqlca)
tab_1.tabpage_3.dw_3.settransobject(sqlca)
tab_1.tabpage_4.dw_4.settransobject(sqlca)
tab_1.tabpage_5.dw_5.settransobject(sqlca)
tab_1.tabpage_6.dw_6.settransobject(sqlca)
tab_1.tabpage_7.dw_7.settransobject(sqlca)
tab_1.tabpage_8.dw_8.settransobject(sqlca)
tab_1.tabpage_9.dw_9.settransobject(sqlca)
tab_1.tabpage_10.dw_10.settransobject(sqlca)
tab_1.tabpage_10.dw_10a.settransobject(sqlca)
tab_1.tabpage_11.dw_11.settransobject(sqlca)
tab_1.tabpage_12.dw_12.settransobject(sqlca)
tab_1.tabpage_13.dw_13.settransobject(sqlca)
tab_1.tabpage_14.dw_14.settransobject(sqlca)
tab_1.tabpage_15.dw_15.settransobject(sqlca)
tab_1.tabpage_16.dw_16.settransobject(sqlca)




wf_new()

  SELECT "SYSCNFG"."DATANAME"  
    INTO :is_Auto
    FROM "SYSCNFG"  
   WHERE ( "SYSCNFG"."SYSGU" = 'S' ) AND  
         ( "SYSCNFG"."SERIAL" = 6 ) AND  
         ( "SYSCNFG"."LINENO" = '20' )   ;

IF SQLCA.SQLCODE <> 0	THEN	is_Auto = 'Y'	

IF is_Auto = 'N'	THEN	cbx_auto.visible = false

string is_version

  SELECT "SYSCNFG"."DATANAME"  
    INTO :is_version
    FROM "SYSCNFG"  
   WHERE ( "SYSCNFG"."SYSGU" = 'C' ) AND  
         ( "SYSCNFG"."SERIAL" = 2 ) AND  
         ( "SYSCNFG"."LINENO" = '1' )   ;

end event

on w_pdm_01040.create
this.pb_4=create pb_4
this.pb_3=create pb_3
this.pb_2=create pb_2
this.pb_1=create pb_1
this.p_inq=create p_inq
this.p_exit=create p_exit
this.p_can=create p_can
this.p_del=create p_del
this.p_mod=create p_mod
this.cbx_auto=create cbx_auto
this.dw_main=create dw_main
this.dw_ip=create dw_ip
this.rr_1=create rr_1
this.rr_5=create rr_5
this.rr_6=create rr_6
this.tab_1=create tab_1
this.Control[]={this.pb_4,&
this.pb_3,&
this.pb_2,&
this.pb_1,&
this.p_inq,&
this.p_exit,&
this.p_can,&
this.p_del,&
this.p_mod,&
this.cbx_auto,&
this.dw_main,&
this.dw_ip,&
this.rr_1,&
this.rr_5,&
this.rr_6,&
this.tab_1}
end on

on w_pdm_01040.destroy
destroy(this.pb_4)
destroy(this.pb_3)
destroy(this.pb_2)
destroy(this.pb_1)
destroy(this.p_inq)
destroy(this.p_exit)
destroy(this.p_can)
destroy(this.p_del)
destroy(this.p_mod)
destroy(this.cbx_auto)
destroy(this.dw_main)
destroy(this.dw_ip)
destroy(this.rr_1)
destroy(this.rr_5)
destroy(this.rr_6)
destroy(this.tab_1)
end on

event closequery;string s_frday, s_frtime

IF is_usegub = 'Y' THEN
	s_frday = f_today()
	
	s_frtime = f_totime()

   UPDATE "PGM_HISTORY"  
      SET "EDATE" = :s_frday,   
          "ETIME" = :s_frtime  
    WHERE ( "PGM_HISTORY"."L_USERID" = :gs_userid ) AND  
          ( "PGM_HISTORY"."CDATE" = :is_today ) AND  
          ( "PGM_HISTORY"."STIME" = :is_totime ) AND  
          ( "PGM_HISTORY"."WINDOW_NAME" = :is_window_id )   ;

	IF SQLCA.SQLCODE = 0 THEN 
	   COMMIT;
   ELSE 	  
	   ROLLBACK;
   END IF	  
END IF	  

w_mdi_frame.st_window.Text = ''

long li_index

li_index = w_mdi_frame.dw_listbar.Find("window_id = '" + Upper(This.ClassName()) + "'", 1, w_mdi_frame.dw_listbar.RowCount())

w_mdi_frame.dw_listbar.DeleteRow(li_index)
w_mdi_frame.Postevent("ue_barrefresh")

end event

type pb_4 from picturebutton within w_pdm_01040
integer x = 1230
integer y = 68
integer width = 82
integer height = 72
integer taborder = 40
integer textsize = -9
integer weight = 700
fontcharset fontcharset = hangeul!
fontpitch fontpitch = fixed!
fontfamily fontfamily = modern!
string facename = "굴림체"
string pointer = "C:\erpman\cur\last.cur"
string picturename = "C:\erpman\image\last.gif"
alignment htextalign = left!
end type

event clicked;wf_scroll(4)


end event

type pb_3 from picturebutton within w_pdm_01040
integer x = 1138
integer y = 68
integer width = 82
integer height = 72
integer taborder = 50
integer textsize = -9
integer weight = 700
fontcharset fontcharset = hangeul!
fontpitch fontpitch = fixed!
fontfamily fontfamily = modern!
string facename = "굴림체"
string pointer = "C:\erpman\cur\next.cur"
string picturename = "C:\erpman\image\next.gif"
alignment htextalign = left!
end type

event clicked;wf_scroll(3)


end event

type pb_2 from picturebutton within w_pdm_01040
integer x = 1047
integer y = 68
integer width = 82
integer height = 72
integer taborder = 60
integer textsize = -9
integer weight = 700
fontcharset fontcharset = hangeul!
fontpitch fontpitch = fixed!
fontfamily fontfamily = modern!
string facename = "굴림체"
string pointer = "C:\erpman\cur\prior.cur"
string picturename = "C:\erpman\image\prior.gif"
alignment htextalign = left!
end type

event clicked;wf_scroll(2)


end event

type pb_1 from picturebutton within w_pdm_01040
integer x = 955
integer y = 68
integer width = 82
integer height = 72
integer taborder = 20
integer textsize = -9
integer weight = 700
fontcharset fontcharset = hangeul!
fontpitch fontpitch = fixed!
fontfamily fontfamily = modern!
string facename = "굴림체"
string pointer = "C:\erpman\cur\first.cur"
boolean originalsize = true
string picturename = "C:\erpman\image\first.gif"
alignment htextalign = left!
end type

event clicked;wf_scroll(1)


end event

type p_inq from uo_picture within w_pdm_01040
integer x = 3707
integer y = 16
integer width = 178
integer taborder = 30
string pointer = "C:\erpman\cur\retrieve.cur"
boolean originalsize = true
string picturename = "C:\erpman\image\조회_up.gif"
end type

event clicked;call super::clicked;w_mdi_frame.sle_msg.text = ''

IF dw_ip.AcceptText() = -1	THEN
	dw_ip.SetFocus()
	return
END IF

string	sCode1, get_nm, sCode2, snull

setnull(snull)

sCode1 = dw_ip.GetItemString(1, 'vndcod')    //거래처코드
sCode2 = dw_ip.GetItemString(1, 'custno')    //고객번호

IF IsNull(sCode1)	 or  sCode1 = ''	THEN
	f_message_chk(30,'[거래처코드]')
	dw_ip.SetColumn("vndcod")
	dw_ip.SetFocus()
	RETURN
END IF

SetPointer(HourGlass!)

dw_main.setredraw(false)
IF dw_main.Retrieve(sCode1) > 0		THEN

   SELECT "CUSTOMER"."CUST_NO"  
     INTO :get_nm  
     FROM "CUSTOMER"  
    WHERE "CUSTOMER"."CVCOD" = :scode1 AND ROWNUM = 1  ;
   
	if sqlca.sqlcode = 0 then 
      dw_ip.setitem(1, 'custno', get_nm)
	else
      dw_ip.setitem(1, 'custno', snull)
	end if
   
	wf_Query()
ELSE	
	f_message_chk(50,'')
   wf_new()
END IF
dw_main.setredraw(true)

ib_any_typing =False

end event

event ue_lbuttondown;call super::ue_lbuttondown;PictureName = "C:\erpman\image\조회_dn.gif"
end event

event ue_lbuttonup;call super::ue_lbuttonup;PictureName = "C:\erpman\image\조회_up.gif"
end event

type p_exit from uo_picture within w_pdm_01040
integer x = 4402
integer y = 16
integer width = 178
integer taborder = 120
string pointer = "C:\erpman\cur\close.cur"
string picturename = "C:\erpman\image\닫기_up.gif"
end type

event clicked;call super::clicked;
IF wf_warndataloss("종료") = -1 THEN  	RETURN

//show(w_frame)
close(parent)


end event

event ue_lbuttondown;call super::ue_lbuttondown;PictureName = "C:\erpman\image\닫기_dn.gif"
end event

event ue_lbuttonup;call super::ue_lbuttonup;PictureName = "C:\erpman\image\닫기_up.gif"
end event

type p_can from uo_picture within w_pdm_01040
integer x = 4229
integer y = 16
integer width = 178
integer taborder = 110
string pointer = "C:\erpman\cur\cancel.cur"
string picturename = "C:\erpman\image\취소_up.gif"
end type

event clicked;call super::clicked;

wf_New()

w_mdi_frame.sle_msg.text = ''


end event

event ue_lbuttondown;call super::ue_lbuttondown;PictureName = "C:\erpman\image\취소_dn.gif"
end event

event ue_lbuttonup;call super::ue_lbuttonup;PictureName = "C:\erpman\image\취소_up.gif"
end event

type p_del from uo_picture within w_pdm_01040
integer x = 4055
integer y = 16
integer width = 178
integer taborder = 100
string pointer = "C:\erpman\cur\delete.cur"
string picturename = "C:\erpman\image\삭제_up.gif"
end type

event clicked;call super::clicked;Beep (1)

string s_key

w_mdi_frame.sle_msg.text = ''

IF dw_ip.AcceptText() = -1	THEN	RETURN

s_Key = dw_ip.GetItemString(1, "vndcod")

SetPointer(HourGlass!)
//삭제하기전에 삭제여부 체크해야 
w_mdi_frame.sle_msg.text ="삭제 가능여부 체크 중....."
IF wf_cvcod_check(s_key) = -1 THEN 
	w_mdi_frame.sle_msg.text =""
	RETURN
END IF

w_mdi_frame.sle_msg.text =""
IF	 MessageBox("삭제 확인", "삭제하시겠습니까? ",question!, yesno!)  = 2 THEN return  

IF wf_mult_custom('99') = -1	THEN	
	ROLLBACK;
	F_ROLLBACK()
	Return
END IF

dw_main.SetRedraw(False)
dw_main.DeleteRow(0)

IF dw_main.Update() > 0	 THEN
	COMMIT;
	ib_any_typing =False
	w_mdi_frame.sle_msg.text ='자료를 삭제하였습니다!!'
ELSE
	ROLLBACK;
	F_ROLLBACK()
	dw_main.SetRedraw(True)
	Return
END IF

p_can.TriggerEvent(clicked!)   

end event

event ue_lbuttondown;call super::ue_lbuttondown;PictureName = "C:\erpman\image\삭제_dn.gif"
end event

event ue_lbuttonup;call super::ue_lbuttonup;PictureName = "C:\erpman\image\삭제_up.gif"
end event

type p_mod from uo_picture within w_pdm_01040
integer x = 3881
integer y = 16
integer width = 178
integer taborder = 90
string pointer = "C:\erpman\cur\update.cur"
string picturename = "C:\erpman\image\저장_up.gif"
end type

event clicked;call super::clicked;string  s_cvcod, s_cvstatus, s_custno, s_name, s_cvbank

w_mdi_frame.sle_msg.text = ''

IF dw_ip.Accepttext() = -1 THEN 	
	dw_ip.setfocus()
	RETURN
END IF
IF tab_1.tabpage_1.dw_1.Accepttext() = -1 THEN RETURN 

SetPointer(HourGlass!)

w_mdi_frame.sle_msg.text ="자료 유효성 여부 체크 중....."

IF wf_Confirm_key() = -1  THEN 
	w_mdi_frame.sle_msg.text =""
	RETURN
END IF

w_mdi_frame.sle_msg.text =""
IF MessageBox("확인", "저장하시겠습니까?", question!, yesno!) = 2	THEN	RETURN

// 등록시 PK 확인
IF ic_status = '1' THEN
   If is_auto = 'Y' and  cbx_auto.Checked = TRUE THEN
   	IF wf_MaxCustCode() = -1	THEN	
			RETURN
		END IF
	ELSE   
		s_cvcod = dw_ip.getitemstring(1, 'vndcod')
   	dw_main.setitem(1, 'cvcod' , s_cvcod)
   END IF
END IF
//실적거래처가 공백일때는 자기 자신에 거래처코드를 입력한다.
IF trim(tab_1.tabpage_1.dw_1.getitemstring(1, 'salescod')) = "" or &
   isnull(trim(tab_1.tabpage_1.dw_1.getitemstring(1, 'salescod'))) then
	tab_1.tabpage_1.dw_1.setitem(1, 'salescod', dw_ip.getitemstring(1, 'vndcod'))
END IF	

if wf_move() = -1 then return 

IF dw_main.Update() > 0	THEN
   if tab_1.tabpage_4.dw_4.Update() <> 1 then  //차입금
		ROLLBACK USING sqlca;
		F_ROLLBACK()
		Return
   end if		
	
   if tab_1.tabpage_6.dw_6.Update() <> 1 then  //주주명부
		ROLLBACK USING sqlca;
		F_ROLLBACK()
		Return
   end if		

   if tab_1.tabpage_7.dw_7.Update() <> 1 then  //비중도
		ROLLBACK USING sqlca;
		F_ROLLBACK()
		Return
   end if		

   if tab_1.tabpage_10.dw_10a.Update() <> 1 then  //년도별 경영목표
		ROLLBACK USING sqlca;
		F_ROLLBACK()
		Return
   end if		

   if tab_1.tabpage_11.dw_11.Update() <> 1 then  //년도별 매출예상
		ROLLBACK USING sqlca;
		F_ROLLBACK()
		Return
   end if		

   if tab_1.tabpage_12.dw_12.Update() <> 1 then  //일자별 주변의견
		ROLLBACK USING sqlca;
		F_ROLLBACK()
		Return
   end if		

   if tab_1.tabpage_13.dw_13.Update() <> 1 then  //평가도
		ROLLBACK USING sqlca;
		F_ROLLBACK()
		Return
   end if		

   if tab_1.tabpage_14.dw_14.Update() <> 1 then  //종합평가
		ROLLBACK USING sqlca;
		F_ROLLBACK()
		Return
   end if		

   if tab_1.tabpage_15.dw_15.Update() <> 1 then  //특기사항
		ROLLBACK USING sqlca;
		F_ROLLBACK()
		Return
   end if		

	s_cvbank = tab_1.tabpage_1.dw_1.getItemString(1,'cvbank')
	
	tab_1.tabpage_1.dw_17.SetItem(1,'autobank',s_cvbank)
	tab_1.tabpage_1.dw_17.SetItem(1,'person_cd',dw_ip.getitemstring(1, 'vndcod'))
	
   if tab_1.tabpage_1.dw_17.Update() <> 1 then  //지급결제 정보
		ROLLBACK USING sqlca;
		F_ROLLBACK()
		Return
   end if		

	s_cvstatus = dw_Main.getitemstring(1, 'cvstatus')

   IF s_cvstatus = '0' then   
		IF wf_mult_custom('1') = -1	THEN		
			ROLLBACK USING sqlca;
			F_ROLLBACK()
			Return
		End If	
	ELSEIF s_cvstatus = '1' then   //사용중지
		IF wf_mult_custom('97') = -1	THEN	
			ROLLBACK USING sqlca;
			F_ROLLBACK()
			Return
		END IF
	ELSE      //단종
		IF wf_mult_custom('98') = -1	THEN	
			ROLLBACK USING sqlca;
			F_ROLLBACK()
			Return
		END IF
   END IF
	
	//고객마스타에 거래처 코드가 등록되지 않았으면 고객에서 거래처를 셋팅하는 것이므로 
	//고객마스타 거래처코드에 거래처 update 처리해야 함
 	s_custno = dw_ip.getitemstring(1, 'custno')
	If not (s_custno = '' or isnull(s_custno)) then 
		select cvcod 
		  into :s_name 
		  from customer 
		 where cust_no = :s_custno ; 
		 
		IF sqlca.sqlcode <> 0 then 
			ROLLBACK USING sqlca;
			MESSAGEBOX('확 인', '고객정보가 등록되지 않았습니다. 자료를 확인하세요!')
			Return
		ELSE
			IF s_name  = '' or isnull(s_name) THEN 
				s_cvcod = dw_ip.getitemstring(1, 'vndcod')
				
			   UPDATE "CUSTOMER"  
               SET "CVCOD" = :s_cvcod  
             WHERE "CUSTOMER"."CUST_NO" = :s_custno   ;
				 
				IF sqlca.sqlcode <> 0 then 
					ROLLBACK USING sqlca;
					F_ROLLBACK()
					Return
			   END IF
		   END IF
		END IF
			
	End if
	
	COMMIT USING sqlca;	
	ib_any_typing =False
	w_mdi_frame.sle_msg.text ="자료를 저장하였습니다!!"
ELSE
	ROLLBACK USING sqlca;
	F_ROLLBACK()
	Return
END IF

wf_query()		


end event

event ue_lbuttondown;call super::ue_lbuttondown;PictureName = "C:\erpman\image\저장_dn.gif"
end event

event ue_lbuttonup;call super::ue_lbuttonup;PictureName = "C:\erpman\image\저장_up.gif"
end event

type cbx_auto from checkbox within w_pdm_01040
integer x = 1573
integer y = 68
integer width = 498
integer height = 76
integer textsize = -9
integer weight = 700
fontcharset fontcharset = hangeul!
fontpitch fontpitch = fixed!
fontfamily fontfamily = modern!
string facename = "굴림체"
long textcolor = 8388608
long backcolor = 33027312
string text = "자동채번 여부"
boolean checked = true
end type

type dw_main from datawindow within w_pdm_01040
event ue_key pbm_dwnkey
event ue_pressenter pbm_dwnprocessenter
integer x = 183
integer y = 196
integer width = 4334
integer height = 392
integer taborder = 70
string dataobject = "d_pdm_01040"
boolean border = false
boolean livescroll = true
end type

event ue_key;IF keydown(keyF1!) THEN
	TriggerEvent(RbuttonDown!)
END IF
end event

event ue_pressenter;Send( Handle(this), 256, 9, 0 )
Return 1
end event

event dberror;//String  sMsg, sErrorcode, sErrorsyntax, sReturn, sNewline
//Integer iPos, iCount
//
//iCount			= 0
//sNewline			= '~r'
//sReturn			= '~n'
//sErrorcode 		= Left(sqlerrtext, 9)
//iPos 		  		= Len(sqlerrtext) - Pos(sqlerrtext, "No changes made to database.", 1)
//sErrorSyntax	= tRIM(Mid(sqlerrtext, 11, Len(sqlerrtext) - iPos - 11))
//
//For iPos = Len(sErrorSyntax) to 1 STEP -1
//	 sMsg = Mid(sErrorSyntax, ipos, 1)
//	 If sMsg   = sReturn or sMsg = sNewline Then
//		 iCount++
//	 End if
//Next
//
//sErrorSynTax  	= Left(sErrorSyntax, Len(sErrorsyntax) - iCount)
//
//
//str_db_error db_error_msg
//db_error_msg.rowno 	 				= row
//db_error_msg.errorcode 				= sErrorCode
//db_error_msg.errorsyntax_system	= sErrorSyntax
//db_error_msg.errorsyntax_user		= sErrorSyntax
//db_error_msg.errorsqlsyntax			= sqlsyntax
//OpenWithParm(w_error, db_error_msg)
//
//
///*sMsg = "Row No       -> " + String(row) 			 + '~n' + &
//		 "Error Code   -> " + sErrorcode			    + '~n' + &
//		 "Error Syntax -> " + sErrorSyntax			 + '~n' + &
//		 "SqlSyntax    -> " + Sqlsyntax
//	MESSAGEBOX("자료처리중 오류발생", sMsg) */
//
//RETURN 1
end event

event editchanged;ib_any_typing = true
end event

event itemchanged;w_mdi_frame.sle_msg.text = ''
long     get_count
string	sNull, sres_no, sname, saddr, get_zip, get_addr
SetNull(sNull)

IF	this.getcolumnname() = "cvnas" THEN
	sname = this.GETTEXT()

	this.setitem(1, 'cvnas2', left(sname, 20))
	
ELSEIF	this.getcolumnname() = "sano"	THEN
	string	sGubun, SaupNo, DupCheck, DupName, scvcod
	SaupNo = trim(this.GETTEXT())				
	IF IsNull(saupno) OR saupno ="" THEN RETURN 
	scvcod = this.getitemstring(1, "cvcod")
	
   if scvcod = "" or isnull(scvcod) then 
		SELECT "VNDMST"."CVCOD",   "VNDMST"."CVNAS"  
		  INTO :DupCheck,   :DupName  
		  FROM "VNDMST"  
		 WHERE "VNDMST"."SANO" = :SaupNo   ;
   else
		SELECT "VNDMST"."CVCOD",   "VNDMST"."CVNAS"  
		  INTO :DupCheck,   :DupName  
		  FROM "VNDMST"  
		 WHERE "VNDMST"."SANO" = :SaupNo AND "VNDMST"."CVCOD" <> :scvcod  ;
   end if
	
	IF sqlca.sqlcode = 0 THEN
		IF messagebox("사업자등록번호 확인", "등록된 사업자등록번호입니다.~n~r" 	&
						+ "거래처번호 : " + DupCheck + "~n~r거래처   명 : " + DupName + "~n~n" + &
						  "계속하시겠습니까?",Question!,YesNo!, 2) = 2 then
			this.setitem(1, "sano", sNull)
			return 1
		END IF
	END IF
	IF f_vendcode_check(saupno) = False THEN
		IF MessageBox("확 인","사업자등록번호가 틀렸습니다. 계속하시겠습니까?",Question!,YesNo!) = 2 then
			this.SetItem(this.GetRow(),"sano",snull)
			Return 1
		END IF	
	END IF
ELSEIF this.GetColumnName() = "resident" THEN
	sres_no = trim(this.GETTEXT())				
	
	IF sres_no = "" OR IsNull(sres_no) THEN RETURN
	
	IF f_vendcode_check(sres_no) = False THEN
		IF MessageBox("확 인","주민등록번호가 틀렸습니다. 계속하시겠습니까?",Question!,YesNo!) = 2 then
			this.SetItem(this.GetRow(),"resident",snull)
			Return 1
		END IF
	END IF
ELSEIF this.GetColumnName() ="addr1" THEN
	saddr = this.GetText()
	
	IF IsNull(saddr) OR saddr ="" then
		return 
   ELSE
		saddr = '%' + saddr + '%'
	END IF
	
   SELECT COUNT(*), MAX(ZIP), MAX(ADDR)  
     INTO :get_count, :get_zip, :get_addr
     FROM P0_ZIP  
    WHERE ADDR like :saddr   ;

	IF get_count = 1 THEN 
		this.SetItem(1,"posno", get_zip)
		this.SetItem(1,"addr1", get_addr)
		return 1
	ELSEIF get_count > 1 THEN 
		this.TriggerEvent(RbuttonDown!)
		IF gs_code ="" OR IsNull(gs_code) THEN 
			this.SetItem(1,"posno", snull)
			this.SetItem(1,"addr1", snull)
		END IF
		Return 1	
	ELSE
	   return
	END IF	
END IF

end event

event rbuttondown;SetNull(Gs_code)
SetNull(Gs_codename)

IF this.GetColumnName() ="addr1" THEN
	
	Gs_code = this.GetText()
	
	IF IsNull(Gs_code) THEN Gs_code =""

	Open(w_zip_popup)
	
	IF isnull(gs_Code)  or  gs_Code = ''	then  return
	
	this.SetItem(1,"posno",Gs_code)
	this.SetItem(1,"addr1",Gs_codename)
	
	this.SetColumn("addr2")
	this.SetFocus()
ELSEIF this.GetColumnName() ="posno" THEN
	IF IsNull(Gs_code) THEN Gs_code =""
	
	Open(w_zip_popup)
	
	IF IsNull(Gs_Code) THEN RETURN
	
	this.SetItem(1,"posno",Gs_code)
	this.SetItem(1,"addr1",Gs_codename)
	
	this.SetColumn("addr2")
	this.SetFocus()
END IF
end event

event itemerror;return 1
end event

event updatestart;///* Update() function 호출시 user 설정 */
//long k, lRowCount
//
//lRowCount = this.RowCount()
//
//FOR k = 1 TO lRowCount
//   IF NewModified! = this.GetItemStatus(k, 0, Primary!) THEN
// 	   This.SetItem(k,'crt_user',gs_userid)
//   ELSEIF DataModified! = this.GetItemStatus(k, 0, Primary!) THEN 		
//	   This.SetItem(k,'upd_user',gs_userid)
//   END IF	  
//NEXT
//
//
end event

type dw_ip from datawindow within w_pdm_01040
event ue_key pbm_dwnkey
event ue_presenter pbm_dwnprocessenter
integer x = 128
integer y = 72
integer width = 1102
integer height = 80
integer taborder = 10
string dataobject = "d_pdm_01040_a"
boolean border = false
end type

event ue_key;IF keydown(keyF1!) THEN
	TriggerEvent(RbuttonDown!)
END IF


end event

event ue_presenter;Send( Handle(this), 256, 9, 0 )
Return 1
end event

event itemchanged;w_mdi_frame.sle_msg.text = ''

String sNull, sname, scvcod
String CUST_NAME,  CUST_NAME_S,  CUST_STS,    LAWNO,     SANO,      UPTAE,  &
		 JONGK,      OWNAM,        RESIDENT,    CVPLN,     POSNO,     ADDR1,  &
		 ADDR2,      TELDDD,       TELNO1,      TELNO2,    FAXDDD,    FAXNO1,  & 
 		 FAXNO2,     EMAIL,        HOMEPAGE,    SABU,      SAREA, &
  		 AREACD,     AREANM,       MARKETCODE,  MARKETNAME,   &
		 CVCOD,      CDATE,        CRDAT,       PDATE,     SDATE,     EDATE,   &
  		 MLEVEL,     EXAREA,       JONGTYPE,    COSIZE,    &
		 KDATE,     SOYOUJA,  & 
		 SOGUAN,     INGUAN,       DAJIGUN,     SULJUNG,   IPJOGUN,   GADONG,   &
		 SANGSAN,    JUPROD,       JUHANDLE,    JUMAEIP,   JUMAECHUL, JUBANK,   &
		 KYUNGY,     GIBONBANG,    HUGYUJA,     DANMOCK,   JUNGMOCK,  JANGMOCK,  & 
		 REWAPUNISH  
Long   INWON     
Double TOTCR,   INMONEY,    OWNMONEY,     TOTSALES,    BENEFIT  

SetNull(sNull)

IF this.GetColumnName() ="vndcod" THEN 
	
	scvcod = this.GetText()
	
	IF scvcod = "" OR IsNull(scvcod) THEN
		this.setitem(1, 'custno', snull)
		RETURN
   END IF
	
	SELECT "VNDMST"."CVNAS2"  
	  INTO :sname  
	  FROM "VNDMST"  
    WHERE "VNDMST"."CVCOD" = :scvcod   ;

	IF SQLCA.SQLCODE = 0 THEN
		p_inq.TriggerEvent(Clicked!)
	END IF

ELSEIF this.GetColumnName() ="custno" THEN
	
	scvcod = this.GetText()
	
	IF scvcod = "" OR IsNull(scvcod) THEN RETURN

	  SELECT A.CUST_NAME, A.CUST_NAME_S, A.CUST_STS,   A.LAWNO,    A.SANO,     A.UPTAE,  
				A.JONGK,     A.OWNAM,       A.RESIDENT,   A.CVPLN,    A.POSNO,    A.ADDR1,  
				A.ADDR2,     A.TELDDD,      A.TELNO1,     A.TELNO2,   A.FAXDDD,   A.FAXNO1,   
				A.FAXNO2,    A.EMAIL,       A.HOMEPAGE,   A.SABU,     A.SAREA,
				A.AREACD,    B.AREANM,      A.MARKETCODE, C.MARKETNAME,   
				A.CVCOD,     A.CDATE,       A.CRDAT,      A.PDATE,    A.SDATE,    A.EDATE,   
				A.MLEVEL,    A.EXAREA,      A.JONGTYPE,   A.COSIZE,   A.INWON,    A.TOTCR,   
				A.INMONEY,   A.OWNMONEY,    A.TOTSALES,   A.BENEFIT,  A.KDATE,    A.SOYOUJA,   
				A.SOGUAN,    A.INGUAN,      A.DAJIGUN,    A.SULJUNG,  A.IPJOGUN,  A.GADONG,   
				A.SANGSAN,   A.JUPROD,      A.JUHANDLE,   A.JUMAEIP,  A.JUMAECHUL,A.JUBANK,   
				A.KYUNGY,    A.GIBONBANG,   A.HUGYUJA,    A.DANMOCK,  A.JUNGMOCK, A.JANGMOCK,   
				A.REWAPUNISH  
	    INTO :CUST_NAME,  :CUST_NAME_S,  :CUST_STS,    :LAWNO,     :SANO,      :UPTAE,  
				:JONGK,      :OWNAM,        :RESIDENT,    :CVPLN,     :POSNO,     :ADDR1,  
				:ADDR2,      :TELDDD,       :TELNO1,      :TELNO2,    :FAXDDD,    :FAXNO1,   
				:FAXNO2,     :EMAIL,        :HOMEPAGE,    :SABU,      :SAREA,
				:AREACD,     :AREANM,       :MARKETCODE,  :MARKETNAME,   
				:CVCOD,      :CDATE,        :CRDAT,       :PDATE,     :SDATE,     :EDATE,   
				:MLEVEL,     :EXAREA,       :JONGTYPE,    :COSIZE,    :INWON,     :TOTCR,   
				:INMONEY,    :OWNMONEY,     :TOTSALES,    :BENEFIT,   :KDATE,     :SOYOUJA,   
				:SOGUAN,     :INGUAN,       :DAJIGUN,     :SULJUNG,   :IPJOGUN,   :GADONG,   
				:SANGSAN,    :JUPROD,       :JUHANDLE,    :JUMAEIP,   :JUMAECHUL, :JUBANK,   
				:KYUNGY,     :GIBONBANG,    :HUGYUJA,     :DANMOCK,   :JUNGMOCK,  :JANGMOCK,   
				:REWAPUNISH  
		 FROM CUSTOMER A,  AREA B, MARKET C  
		WHERE A.AREACD     = B.AREACD (+)
		  AND A.MARKETCODE = C.MARKETCODE (+)
        AND A.CUST_NO    = :scvcod   ;

	IF SQLCA.SQLCODE = 0 THEN
		if cvcod = '' or isnull(cvcod) then 
			tab_1.tabpage_1.dw_1.Setitem(1, 'sarea', sarea)
			tab_1.tabpage_1.dw_1.Setitem(1, 'areacd', areacd)
			tab_1.tabpage_1.dw_1.Setitem(1, 'area_areanm', areanm)
			tab_1.tabpage_1.dw_1.Setitem(1, 'marketcode', marketcode)
			tab_1.tabpage_1.dw_1.Setitem(1, 'market_marketname', marketname)
			tab_1.tabpage_1.dw_1.Setitem(1, 'pdate', pdate)
			tab_1.tabpage_1.dw_1.Setitem(1, 'sdate', sdate)
			tab_1.tabpage_1.dw_1.Setitem(1, 'edate', edate)
			tab_1.tabpage_1.dw_1.Setitem(1, 'mlevel', mlevel)
			tab_1.tabpage_1.dw_1.Setitem(1, 'exarea', exarea)
			tab_1.tabpage_1.dw_1.Setitem(1, 'jongtype', jongtype)
			tab_1.tabpage_1.dw_1.Setitem(1, 'cvbank', jubank)
			
			dw_main.Setitem(1, 'cvnas', cust_name)
			dw_main.Setitem(1, 'cvnas2', cust_name_s)
			
			if cust_sts = '4' then 
				cust_sts = '1' 
			elseif cust_sts = '5' then 
				cust_sts = '2' 
			else
				cust_sts = '0' 
			end if
			dw_main.Setitem(1, 'cvstatus', cust_sts)
			dw_main.Setitem(1, 'lawno', lawno)
			dw_main.Setitem(1, 'sano', sano)
			dw_main.Setitem(1, 'uptae', uptae)
			dw_main.Setitem(1, 'jongk', jongk)
			dw_main.Setitem(1, 'ownam', ownam)
			dw_main.Setitem(1, 'resident', resident)
			dw_main.Setitem(1, 'cvpln', cvpln)
			dw_main.Setitem(1, 'posno', posno)
			dw_main.Setitem(1, 'addr1', addr1)
			dw_main.Setitem(1, 'addr2', addr2)
			dw_main.Setitem(1, 'telddd', telddd)
			dw_main.Setitem(1, 'telno1', telno1)
			dw_main.Setitem(1, 'telno2', telno2)
			dw_main.Setitem(1, 'faxddd', faxddd)
			dw_main.Setitem(1, 'faxno1', faxno1)
			dw_main.Setitem(1, 'faxno2', faxno2)
			dw_main.Setitem(1, 'email', email)
			dw_main.Setitem(1, 'homepage', homepage)
			dw_main.Setitem(1, 'cosize', cosize)
			
			tab_1.tabpage_2.dw_2.Setitem(1, 'inwon', inwon)
			tab_1.tabpage_2.dw_2.Setitem(1, 'totcr', totcr)
			tab_1.tabpage_2.dw_2.Setitem(1, 'cdate', cdate)
			tab_1.tabpage_2.dw_2.Setitem(1, 'totsales', totsales)
			tab_1.tabpage_2.dw_2.Setitem(1, 'inmoney', inmoney)
			tab_1.tabpage_2.dw_2.Setitem(1, 'crdat', crdat)
			tab_1.tabpage_2.dw_2.Setitem(1, 'benefit', benefit)
			tab_1.tabpage_2.dw_2.Setitem(1, 'ownmoney', ownmoney)
			tab_1.tabpage_2.dw_2.Setitem(1, 'kdate', kdate)
			tab_1.tabpage_2.dw_2.Setitem(1, 'soyouja', soyouja)
			tab_1.tabpage_2.dw_2.Setitem(1, 'soguan', soguan)
			tab_1.tabpage_2.dw_2.Setitem(1, 'inguan', inguan)
			tab_1.tabpage_2.dw_2.Setitem(1, 'dajigun', dajigun)
			tab_1.tabpage_2.dw_2.Setitem(1, 'suljung', suljung)
			tab_1.tabpage_2.dw_2.Setitem(1, 'ipjogun', ipjogun)
			tab_1.tabpage_2.dw_2.Setitem(1, 'gadong', gadong)
			tab_1.tabpage_2.dw_2.Setitem(1, 'sangsan', sangsan)
			tab_1.tabpage_2.dw_2.Setitem(1, 'juprod', juprod)
			tab_1.tabpage_2.dw_2.Setitem(1, 'juhandle', juhandle)
			tab_1.tabpage_2.dw_2.Setitem(1, 'jumaeip', jumaeip)
			tab_1.tabpage_2.dw_2.Setitem(1, 'jumaechul', jumaechul)
			tab_1.tabpage_2.dw_2.Setitem(1, 'rewapunish', rewapunish)

			tab_1.tabpage_9.dw_9.Setitem(1, 'kyungy', kyungy)
			tab_1.tabpage_9.dw_9.Setitem(1, 'gibonbang', gibonbang)
			tab_1.tabpage_9.dw_9.Setitem(1, 'hugyuja', hugyuja)

			//dw_10 데이타(경영목표) move   	
			tab_1.tabpage_10.dw_10.Setitem(1, 'danmock', danmock)
			tab_1.tabpage_10.dw_10.Setitem(1, 'jungmock', jungmock)
			tab_1.tabpage_10.dw_10.Setitem(1, 'jangmock', jangmock)
			
		else
	      this.setitem(1, 'vndcod', cvcod)      
			p_inq.TriggerEvent(Clicked!)
		end if
	ELSE
      F_message_chk(33, "[고객번호]")
      this.setitem(1, 'custno', snull)      
	END IF

END IF


end event

event itemerror;return 1
end event

event rbuttondown;setnull(gs_code)
setnull(gs_codename)
setnull(gs_gubun)

IF this.GetColumnName() = "vndcod" THEN
   gs_gubun = '1'   
	gi_page = -1 
   Open(w_vndmst_popup)
	gi_page = 0 

	IF isnull(gs_Code)  or  gs_Code = ''	then  return

	dw_ip.SetItem(1, "vndcod", gs_Code)
	
	this.TriggerEvent(ItemChanged!)
ELSEIF this.GetColumnName() = "custno" THEN
	
	Open(w_cust_popup)

	IF isnull(gs_Code)  or  gs_Code = ''	then  return

	dw_ip.SetItem(1, "custno", gs_Code)
	
	this.TriggerEvent(ItemChanged!)
END IF



end event

event losefocus;THIS.accepttext()
end event

type rr_1 from roundrectangle within w_pdm_01040
long linecolor = 28144969
integer linethickness = 1
long fillcolor = 33027312
integer x = 110
integer y = 176
integer width = 4462
integer height = 436
integer cornerheight = 40
integer cornerwidth = 55
end type

type rr_5 from roundrectangle within w_pdm_01040
long linecolor = 28144969
integer linethickness = 1
long fillcolor = 33027312
integer x = 1536
integer y = 48
integer width = 562
integer height = 112
integer cornerheight = 40
integer cornerwidth = 55
end type

type rr_6 from roundrectangle within w_pdm_01040
long linecolor = 28144969
integer linethickness = 1
long fillcolor = 33027312
integer x = 110
integer y = 48
integer width = 1253
integer height = 112
integer cornerheight = 40
integer cornerwidth = 55
end type

type tab_1 from tab within w_pdm_01040
integer x = 105
integer y = 620
integer width = 4457
integer height = 1660
integer taborder = 80
integer textsize = -9
integer weight = 400
fontcharset fontcharset = hangeul!
fontpitch fontpitch = fixed!
fontfamily fontfamily = modern!
string facename = "굴림체"
long backcolor = 32106727
boolean fixedwidth = true
boolean multiline = true
boolean raggedright = true
boolean boldselectedtext = true
integer selectedtab = 1
tabpage_1 tabpage_1
tabpage_3 tabpage_3
tabpage_5 tabpage_5
tabpage_7 tabpage_7
tabpage_9 tabpage_9
tabpage_11 tabpage_11
tabpage_13 tabpage_13
tabpage_15 tabpage_15
tabpage_2 tabpage_2
tabpage_4 tabpage_4
tabpage_6 tabpage_6
tabpage_8 tabpage_8
tabpage_10 tabpage_10
tabpage_12 tabpage_12
tabpage_14 tabpage_14
tabpage_16 tabpage_16
end type

on tab_1.create
this.tabpage_1=create tabpage_1
this.tabpage_3=create tabpage_3
this.tabpage_5=create tabpage_5
this.tabpage_7=create tabpage_7
this.tabpage_9=create tabpage_9
this.tabpage_11=create tabpage_11
this.tabpage_13=create tabpage_13
this.tabpage_15=create tabpage_15
this.tabpage_2=create tabpage_2
this.tabpage_4=create tabpage_4
this.tabpage_6=create tabpage_6
this.tabpage_8=create tabpage_8
this.tabpage_10=create tabpage_10
this.tabpage_12=create tabpage_12
this.tabpage_14=create tabpage_14
this.tabpage_16=create tabpage_16
this.Control[]={this.tabpage_1,&
this.tabpage_3,&
this.tabpage_5,&
this.tabpage_7,&
this.tabpage_9,&
this.tabpage_11,&
this.tabpage_13,&
this.tabpage_15,&
this.tabpage_2,&
this.tabpage_4,&
this.tabpage_6,&
this.tabpage_8,&
this.tabpage_10,&
this.tabpage_12,&
this.tabpage_14,&
this.tabpage_16}
end on

on tab_1.destroy
destroy(this.tabpage_1)
destroy(this.tabpage_3)
destroy(this.tabpage_5)
destroy(this.tabpage_7)
destroy(this.tabpage_9)
destroy(this.tabpage_11)
destroy(this.tabpage_13)
destroy(this.tabpage_15)
destroy(this.tabpage_2)
destroy(this.tabpage_4)
destroy(this.tabpage_6)
destroy(this.tabpage_8)
destroy(this.tabpage_10)
destroy(this.tabpage_12)
destroy(this.tabpage_14)
destroy(this.tabpage_16)
end on

type tabpage_1 from userobject within tab_1
integer x = 18
integer y = 176
integer width = 4421
integer height = 1468
long backcolor = 32106727
string text = "관리정보"
long tabtextcolor = 33554432
long tabbackcolor = 32106727
long picturemaskcolor = 536870912
dw_17 dw_17
dw_1 dw_1
rr_2 rr_2
end type

on tabpage_1.create
this.dw_17=create dw_17
this.dw_1=create dw_1
this.rr_2=create rr_2
this.Control[]={this.dw_17,&
this.dw_1,&
this.rr_2}
end on

on tabpage_1.destroy
destroy(this.dw_17)
destroy(this.dw_1)
destroy(this.rr_2)
end on

type dw_17 from datawindow within tabpage_1
integer x = 146
integer y = 816
integer width = 4137
integer height = 580
integer taborder = 90
string title = "none"
string dataobject = "d_pdm_01040_17"
boolean border = false
boolean livescroll = true
end type

type dw_1 from datawindow within tabpage_1
event ue_key pbm_dwnkey
event ue_pressenter pbm_dwnprocessenter
integer x = 101
integer y = 44
integer width = 4219
integer height = 1016
integer taborder = 20
string dataobject = "d_pdm_01040_01"
boolean border = false
boolean livescroll = true
end type

event ue_key;IF keydown(keyF1!) THEN
	TriggerEvent(RbuttonDown!)
END IF
end event

event ue_pressenter;Send( Handle(this), 256, 9, 0 )
Return 1
end event

event editchanged;ib_any_typing = true
end event

event rbuttondown;SetNull(Gs_gubun)
SetNull(Gs_code)
SetNull(Gs_codename)

IF this.GetColumnName() = "deptcode" THEN
	Open(w_vndmst_4_popup)

	IF isnull(gs_Code)  or  gs_Code = ''	then  return

	this.SetItem(1, "deptcode", gs_Code)
	this.SetItem(1, "p0_dept_deptname2", gs_Codename)
ElseIF this.GetColumnName() = "outorder_dept" THEN
	Open(w_vndmst_4_popup)

	IF isnull(gs_Code)  or  gs_Code = ''	then  return

	this.SetItem(1, "outorder_dept", gs_Code)
	this.SetItem(1, "outname", gs_Codename)	
ELSEIF this.GetColumnName() = "areacd" THEN
	Open(w_nation_popup)

	IF isnull(gs_Code)  or  gs_Code = ''	then  return

	this.SetItem(1, "areacd", gs_Code)
	this.SetItem(1, "area_areanm", gs_Codename)
ELSEIF this.GetColumnName() = "marketcode" THEN
	Open(w_market_popup)

	IF isnull(gs_Code)  or  gs_Code = ''	then  return

	this.SetItem(1, "marketcode", gs_Code)
	this.SetItem(1, "market_marketname", gs_Codename)
ELSEIF this.GetColumnName() = "salescod" THEN
	gs_gubun = '1' 
	
	Open(w_vndmst_popup)

	IF isnull(gs_Code)  or  gs_Code = ''	then  return

	this.SetItem(1, "salescod", gs_Code)
	this.SetItem(1, "vndnm", gs_Codename)
ELSEIF this.GetColumnName() = "pre_cvcod" THEN
	gs_gubun = '1' 
	Open(w_vndmst_popup)

	IF isnull(gs_Code)  or  gs_Code = ''	then  return

	this.SetItem(1, "pre_cvcod", gs_Code)
	this.triggerevent(itemchanged!)
END IF






end event

event itemchanged;string snull, sget_name, sempno, s_date, scvgu, s_name
String sdptno

setnull(snull)

IF this.GetColumnName() = "cvgu" THEN
	scvgu = this.GetText()

	if scvgu ="" or isnull(scvgu) then
		return 
	elseif scvgu = '4'  or scvgu = '5' then 
//	elseif scvgu = '3' or scvgu = '4' or scvgu = '5' then 
	   messagebox("확인", "부서, 창고를 입력할 수 없고 조회만 가능합니다!!") 
		this.SetItem(1,"cvgu",snull)
		return 1
	end if		
	
ELSEIF this.GetColumnName() ="deptcode" THEN
	
	sdptno = this.GetText()
	
	IF sdptno ="" OR IsNull(sdptno) THEN 
		this.SetItem(1,"p0_dept_deptname2",snull)
		RETURN
	END IF
	
	SELECT "VNDMST"."CVNAS2"  INTO :sget_name  
     FROM "VNDMST"  
    WHERE "VNDMST"."CVCOD" = :sdptno  AND "VNDMST"."CVGU" = '4' ;
	  
	IF SQLCA.SQLCODE = 0 THEN
		this.SetItem(1,"p0_dept_deptname2",sget_name)
	ELSE
		this.TriggerEvent(RbuttonDown!)
		IF gs_code ="" OR IsNull(gs_code) THEN 
			this.SetItem(1,"deptcode",snull)
			this.SetItem(1,"p0_dept_deptname2",snull)
		END IF
		
		Return 1	
	END IF
ELSEIF this.GetColumnName() ="outorder_dept" THEN
	
	
	sdptno = this.GetText()
	
	IF sdptno ="" OR IsNull(sdptno) THEN 
		this.SetItem(1,"outname",snull)
		RETURN
	END IF
	
	SELECT "VNDMST"."CVNAS2"  INTO :sget_name  
     FROM "VNDMST"  
    WHERE "VNDMST"."CVCOD" = :sdptno  AND "VNDMST"."CVGU" = '4' ;
	  
	IF SQLCA.SQLCODE = 0 THEN
		this.SetItem(1,"outname",sget_name)
	ELSE
		this.TriggerEvent(RbuttonDown!)
		IF gs_code ="" OR IsNull(gs_code) THEN 
			this.SetItem(1,"outorder_dept",snull)
			this.SetItem(1,"outname",snull)
		END IF
		
		Return 1	
	END IF	
ELSEIF this.GetColumnName() ="areacd" THEN
	
	sempno = this.GetText()
	
	IF sempno ="" OR IsNull(sempno) THEN 
		this.SetItem(1,"area_areanm",snull)
		RETURN
	END IF
	
  SELECT "AREA"."AREANM"  
    INTO :sget_name  
    FROM "AREA"  
   WHERE "AREA"."AREACD" = :sempno   ;

	IF SQLCA.SQLCODE = 0 THEN
		this.SetItem(1,"area_areanm",sget_name)
	ELSE
		this.TriggerEvent(RbuttonDown!)
		IF gs_code ="" OR IsNull(gs_code) THEN
			this.SetItem(1,"areacd",snull)
			this.SetItem(1,"area_areanm",snull)
		END IF
		
		Return 1	
	END IF
ELSEIF this.GetColumnName() ="marketcode" THEN
	
	sempno = this.GetText()
	
	IF sempno ="" OR IsNull(sempno) THEN 
		this.SetItem(1,"market_marketname",snull)
		RETURN
	END IF
	
  SELECT "MARKET"."MARKETNAME"  
    INTO :sget_name  
    FROM "MARKET"  
   WHERE "MARKET"."MARKETCODE" = :sempno   ;

	IF SQLCA.SQLCODE = 0 THEN
		this.SetItem(1,"market_marketname",sget_name)
	ELSE
		this.TriggerEvent(RbuttonDown!)
		IF gs_code ="" OR IsNull(gs_code) THEN
			this.SetItem(1,"marketcode",snull)
			this.SetItem(1,"market_marketname",snull)
		END IF
		
		Return 1	
	END IF
ELSEIF this.GetColumnName() = 'pdate' THEN
	s_date = Trim(this.Gettext())
	IF s_date ="" OR IsNull(s_date) THEN RETURN
	
	IF f_datechk(s_date) = -1 THEN
		f_message_chk(35,'[당사계약일]')
		this.SetItem(1,"pdate",snull)
		this.Setcolumn("pdate")
		this.SetFocus()
		Return 1
	END IF
ELSEIF this.GetColumnName() = 'sdate' THEN
	s_date = Trim(this.Gettext())
	IF s_date ="" OR IsNull(s_date) THEN RETURN
	
	IF f_datechk(s_date) = -1 THEN
		f_message_chk(35,'[거래시작일]')
		this.SetItem(1,"sdate",snull)
		this.Setcolumn("sdate")
		this.SetFocus()
		Return 1
	END IF
ELSEIF this.GetColumnName() = 'edate' THEN
	s_date = Trim(this.Gettext())
	IF s_date ="" OR IsNull(s_date) THEN RETURN
	
	IF f_datechk(s_date) = -1 THEN
		f_message_chk(35,'[거래종료일]')
		this.SetItem(1,"edate",snull)
		this.Setcolumn("edate")
		this.SetFocus()
		Return 1
	END IF
ELSEIF this.GetColumnName() ="salescod" THEN
	sempno = this.GetText()
	
	IF sempno ="" OR IsNull(sempno) THEN 
		this.SetItem(1,"vndnm",snull)
		RETURN
	END IF
	
	SELECT "VNDMST"."CVNAS2"  
	  INTO :sget_name  
	  FROM "VNDMST"  
    WHERE "VNDMST"."CVCOD" = :sempno  ;
	 
	IF SQLCA.SQLCODE = 0 THEN
		this.SetItem(1,"vndnm",sget_name)
	ELSE
		this.TriggerEvent(RbuttonDown!)
		IF gs_code ="" OR IsNull(gs_code) THEN
			this.SetItem(1,"salescod",snull)
			this.SetItem(1,"vndnm",snull)
		END IF
		
		Return 1	
	END IF
	
ELSEIF this.GetColumnName() ="pre_cvcod" THEN
	sempno = this.GetText()
	
	IF sempno ="" OR IsNull(sempno) THEN 
		this.SetItem(1,"pre_cvnas",snull)
		RETURN
	END IF
	
	SELECT "VNDMST"."CVNAS2"  
	  INTO :sget_name  
	  FROM "VNDMST"  
    WHERE "VNDMST"."CVCOD" = :sempno AND "VNDMST"."CVGU" IN ('1', '2', '9') ;
	 
	IF SQLCA.SQLCODE = 0 THEN
		dw_ip.accepttext()
		IF dw_ip.getitemstring(1, 'vndcod') = sempno then 
			MessageBox('확 인', '이전 거래처에 자기자신을 입력할 수 없습니다.')
			this.SetItem(1,"pre_cvcod",snull)
			this.SetItem(1,"pre_cvnas",snull)
			Return 1	
		END IF
		this.SetItem(1,"pre_cvnas",sget_name)
	ELSE
		MessageBox('확 인', '등록된 자료를 입력하세요.')
		this.SetItem(1,"pre_cvcod",snull)
		this.SetItem(1,"pre_cvnas",snull)
		Return 1	
	END IF
	
ELSEIF this.GetColumnName() ="jongtype" THEN
	sempno = this.GetText()

   IF sempno = "" OR IsNull(sempno) THEN RETURN
	
	s_name = f_get_reffer('50', sempno)
	if isnull(s_name) or s_name="" then
		f_message_chk(33,'[업종분류]')
		this.SetItem(1,'jongtype', snull)
		return 1
   end if	
ELSEIF this.GetColumnName() ="rcvmg" THEN
	sempno = this.GetText()

   IF sempno = "" OR IsNull(sempno) THEN RETURN
	
	s_name = f_get_reffer('52', sempno)
	if isnull(s_name) or s_name="" then
		f_message_chk(33,'[결제조건]')
		this.SetItem(1,'rcvmg', snull)
		return 1
   end if	
ELSEIF this.GetColumnName() ="sale_emp" THEN
	sempno = this.GetText()

   IF sempno = "" OR IsNull(sempno) THEN RETURN
	
	s_name = f_get_reffer('47', sempno)
	if isnull(s_name) or s_name="" then
		f_message_chk(33,'[영업담당자]')
		this.SetItem(1,'sale_emp', snull)
		return 1
   end if	
ELSEIF this.GetColumnName() ="emp_id" THEN
	sempno = this.GetText()

   IF sempno = "" OR IsNull(sempno) THEN RETURN
	
	s_name = f_get_reffer('43', sempno)
	if isnull(s_name) or s_name="" then
		f_message_chk(33,'[구매담당자]')
		this.SetItem(1,'emp_id', snull)
		return 1
   end if	
ELSEIF this.GetColumnName() ="exarea" THEN
	sempno = this.GetText()

   IF sempno = "" OR IsNull(sempno) THEN RETURN
	
	s_name = f_get_reffer('37', sempno)
	if isnull(s_name) or s_name="" then
		f_message_chk(33,'[운송지역]')
		this.SetItem(1,'exarea', snull)
		return 1
   end if	
END IF
end event

event itemerror;return 1
end event

type rr_2 from roundrectangle within tabpage_1
long linecolor = 28144969
integer linethickness = 1
long fillcolor = 32106727
integer x = 91
integer y = 36
integer width = 4256
integer height = 1388
integer cornerheight = 40
integer cornerwidth = 55
end type

type tabpage_3 from userobject within tab_1
integer x = 18
integer y = 176
integer width = 4421
integer height = 1468
long backcolor = 32106727
string text = "담보"
long tabbackcolor = 32106727
long picturemaskcolor = 536870912
p_change p_change
p_add p_add
dw_3 dw_3
rr_3 rr_3
end type

on tabpage_3.create
this.p_change=create p_change
this.p_add=create p_add
this.dw_3=create dw_3
this.rr_3=create rr_3
this.Control[]={this.p_change,&
this.p_add,&
this.dw_3,&
this.rr_3}
end on

on tabpage_3.destroy
destroy(this.p_change)
destroy(this.p_add)
destroy(this.dw_3)
destroy(this.rr_3)
end on

type p_change from uo_picture within tabpage_3
integer x = 4210
integer y = 1320
integer width = 178
string pointer = "C:\ERPMAN\CUR\delrow.cur"
string picturename = "C:\erpman\image\행삭제_up.gif"
end type

event clicked;int    il_row

dw_ip.accepttext()

il_Row = tab_1.tabpage_3.dw_3.GetSelectedRow(0)

IF il_Row <= 0 THEN
	f_message_chk(36,'')
	return
END IF

str_cust.st_vndcod = dw_ip.getitemstring(1, 'vndcod')

str_cust.st_custno = tab_1.tabpage_3.dw_3.GetItemString(il_Row, "cust_no")

str_cust.st_seq = tab_1.tabpage_3.dw_3.GetItemNumber(il_Row, "seq")

openwithparm(w_pdm_01040_dambo, str_cust)

tab_1.tabpage_3.dw_3.retrieve(str_cust.st_vndcod)

end event

event ue_lbuttondown;call super::ue_lbuttondown;PictureName = "C:\erpman\image\행삭제_dn.gif"
end event

event ue_lbuttonup;call super::ue_lbuttonup;PictureName = "C:\erpman\image\행삭제_up.gif"
end event

type p_add from uo_picture within tabpage_3
integer x = 4032
integer y = 1320
integer width = 178
string pointer = "C:\ERPMAN\CUR\addrow.cur"
boolean originalsize = true
string picturename = "C:\erpman\image\행추가_up.gif"
end type

event clicked;call super::clicked;dw_ip.accepttext()

str_cust.st_vndcod = dw_ip.getitemstring(1, 'vndcod')

SELECT "CUSTOMER"."CUST_NO"  
  INTO :str_cust.st_custno  
  FROM "CUSTOMER"  
 WHERE "CUSTOMER"."CVCOD" = :str_cust.st_vndcod   ;

if sqlca.sqlcode <> 0 then 
	f_message_chk(41, '')
   return 
else
   SELECT MAX("CUSTDAMBO"."SEQ")  
     INTO :str_cust.st_seq  
     FROM "CUSTDAMBO"  
    WHERE "CUSTDAMBO"."CUST_NO" = :str_cust.st_custno   ;
end if	

if isnull(str_cust.st_seq) then str_cust.st_seq = 0 

str_cust.st_seq = str_cust.st_seq + 1

openwithparm(w_pdm_01040_dambo, str_cust)

tab_1.tabpage_3.dw_3.retrieve(str_cust.st_vndcod)


end event

event ue_lbuttondown;call super::ue_lbuttondown;PictureName = "C:\erpman\image\행추가_dn.gif"
end event

event ue_lbuttonup;call super::ue_lbuttonup;PictureName = "C:\erpman\image\행추가_up.gif"
end event

type dw_3 from datawindow within tabpage_3
integer x = 27
integer y = 36
integer width = 4370
integer height = 1268
integer taborder = 10
string dataobject = "d_pdm_01040_03"
boolean vscrollbar = true
boolean border = false
boolean livescroll = true
end type

event clicked;If Row <= 0 then
	SelectRow(0,False)
ELSE
	SelectRow(0, FALSE)
	SelectRow(Row,TRUE)
END IF

end event

event doubleclicked;int    il_row

dw_ip.accepttext()

IF Row <= 0 THEN
   return
END IF

str_cust.st_vndcod = dw_ip.getitemstring(1, 'vndcod')

str_cust.st_custno = tab_1.tabpage_3.dw_3.GetItemString(Row, "cust_no")

str_cust.st_seq = tab_1.tabpage_3.dw_3.GetItemNumber(Row, "seq")

openwithparm(w_pdm_01040_dambo, str_cust)

tab_1.tabpage_3.dw_3.retrieve(str_cust.st_vndcod)

end event

type rr_3 from roundrectangle within tabpage_3
long linecolor = 28144969
integer linethickness = 1
long fillcolor = 32106727
integer x = 14
integer y = 24
integer width = 4398
integer height = 1292
integer cornerheight = 40
integer cornerwidth = 55
end type

type tabpage_5 from userobject within tab_1
integer x = 18
integer y = 176
integer width = 4421
integer height = 1468
long backcolor = 32106727
string text = "임직원"
long tabbackcolor = 32106727
long picturemaskcolor = 536870912
p_a5 p_a5
dw_5 dw_5
rr_11 rr_11
end type

on tabpage_5.create
this.p_a5=create p_a5
this.dw_5=create dw_5
this.rr_11=create rr_11
this.Control[]={this.p_a5,&
this.dw_5,&
this.rr_11}
end on

on tabpage_5.destroy
destroy(this.p_a5)
destroy(this.dw_5)
destroy(this.rr_11)
end on

type p_a5 from uo_picture within tabpage_5
integer x = 4219
integer y = 24
integer width = 178
string pointer = "C:\ERPMAN\CUR\addrow.cur"
boolean originalsize = true
string picturename = "C:\erpman\image\행추가_up.gif"
end type

event clicked;call super::clicked;dw_ip.accepttext()

str_cust.st_vndcod = dw_ip.getitemstring(1, 'vndcod')

SELECT "CUSTOMER"."CUST_NO"  
  INTO :str_cust.st_custno  
  FROM "CUSTOMER"  
 WHERE "CUSTOMER"."CVCOD" = :str_cust.st_vndcod   ;

if sqlca.sqlcode <> 0 then 
	f_message_chk(41, '')
   return 
else
	SELECT MAX("CUSTSTAFF"."SEQ")  
     INTO :str_cust.st_seq    
     FROM "CUSTSTAFF"  
    WHERE "CUSTSTAFF"."CUST_NO" = :str_cust.st_custno   ;
end if	

if isnull(str_cust.st_seq) then str_cust.st_seq = 0 

str_cust.st_seq = str_cust.st_seq + 1

openwithparm(w_pdm_01040_staff, str_cust)

tab_1.tabpage_5.dw_5.retrieve(str_cust.st_vndcod)


end event

event ue_lbuttonup;call super::ue_lbuttonup;PictureName = "C:\erpman\image\행추가_up.gif"
end event

event ue_lbuttondown;call super::ue_lbuttondown;PictureName = "C:\erpman\image\행추가_dn.gif"
end event

type dw_5 from datawindow within tabpage_5
integer x = 23
integer y = 32
integer width = 4151
integer height = 1352
integer taborder = 10
string dataobject = "d_pdm_01040_05"
boolean vscrollbar = true
boolean border = false
boolean livescroll = true
end type

event doubleclicked;int    il_row

dw_ip.accepttext()

IF Row <= 0 THEN
   return
END IF

str_cust.st_vndcod = dw_ip.getitemstring(1, 'vndcod')

str_cust.st_custno = tab_1.tabpage_5.dw_5.GetItemString(Row, "cust_no")

str_cust.st_seq = tab_1.tabpage_5.dw_5.GetItemNumber(Row, "seq")

openwithparm(w_pdm_01040_staff, str_cust)

tab_1.tabpage_5.dw_5.retrieve(str_cust.st_vndcod)

end event

event clicked;If Row <= 0 then
	SelectRow(0,False)
ELSE
	SelectRow(0, FALSE)
	SelectRow(Row,TRUE)
END IF

end event

type rr_11 from roundrectangle within tabpage_5
long linecolor = 28144969
integer linethickness = 1
long fillcolor = 32106727
integer x = 14
integer y = 24
integer width = 4174
integer height = 1368
integer cornerheight = 40
integer cornerwidth = 55
end type

type tabpage_7 from userobject within tab_1
integer x = 18
integer y = 176
integer width = 4421
integer height = 1468
long backcolor = 32106727
string text = "비중도"
long tabbackcolor = 32106727
long picturemaskcolor = 553648127
p_5 p_5
p_7a p_7a
dw_7 dw_7
rr_12 rr_12
end type

on tabpage_7.create
this.p_5=create p_5
this.p_7a=create p_7a
this.dw_7=create dw_7
this.rr_12=create rr_12
this.Control[]={this.p_5,&
this.p_7a,&
this.dw_7,&
this.rr_12}
end on

on tabpage_7.destroy
destroy(this.p_5)
destroy(this.p_7a)
destroy(this.dw_7)
destroy(this.rr_12)
end on

type p_5 from uo_picture within tabpage_7
integer x = 4210
integer y = 176
integer width = 178
string pointer = "c:\erpman\cur\delrow.cur"
string picturename = "C:\erpman\image\행삭제_up.gif"
end type

event clicked;call super::clicked;long 	curr_row

curr_row = tab_1.tabpage_7.dw_7.getrow()

if f_msg_delete() = -1 then return

if curr_row > 0  then
   tab_1.tabpage_7.dw_7.deleterow(curr_row)
	IF tab_1.tabpage_7.dw_7.Update() = 1 THEN
		COMMIT;
		
   	tab_1.tabpage_7.dw_7.setcolumn('yyyymm')
   	tab_1.tabpage_7.dw_7.setfocus()
	ELSE
		ROLLBACK;
		RETURN
	END IF
end if
ib_any_typing = false
end event

type p_7a from uo_picture within tabpage_7
integer x = 4210
integer y = 36
integer width = 178
string pointer = "C:\ERPMAN\CUR\addrow.cur"
boolean originalsize = true
string picturename = "C:\erpman\image\행추가_up.gif"
end type

event clicked;call super::clicked;long curr_row, i
string scustno

if dw_ip.AcceptText() = -1 then return -1
if tab_1.tabpage_7.dw_7.AcceptText() = -1 then return -1

FOR i = 1 TO tab_1.tabpage_7.dw_7.RowCount()
	if isnull(tab_1.tabpage_7.dw_7.GetItemstring(i,'yyyymm')) or &
		tab_1.tabpage_7.dw_7.GetItemString(i,'yyyymm') = "" then
		f_message_chk(1400,'[ '+string(i)+' 행 년월]')
		tab_1.tabpage_7.dw_7.ScrollToRow(i)
		tab_1.tabpage_7.dw_7.SetColumn('yyyymm')
		tab_1.tabpage_7.dw_7.SetFocus()
		return -1		
	end if	
NEXT

curr_row = tab_1.tabpage_7.dw_7.insertrow(0)

scustno = dw_ip.getitemstring(1, 'custno') 

tab_1.tabpage_7.dw_7.setitem(curr_row, "cust_no", scustno)

tab_1.tabpage_7.dw_7.setcolumn('yyyymm')
tab_1.tabpage_7.dw_7.setrow(curr_row)
tab_1.tabpage_7.dw_7.scrolltorow(curr_row)

tab_1.tabpage_7.dw_7.setfocus()


end event

type dw_7 from datawindow within tabpage_7
event ue_presenter pbm_dwnprocessenter
integer x = 18
integer y = 28
integer width = 4155
integer height = 1344
integer taborder = 10
string dataobject = "d_pdm_01040_07"
boolean vscrollbar = true
boolean border = false
boolean livescroll = true
end type

event ue_presenter;Send( Handle(this), 256, 9, 0 )
Return 1


end event

event dberror;String  sMsg, sErrorcode, sErrorsyntax, sReturn, sNewline
Integer iPos, iCount

iCount			= 0
sNewline			= '~r'
sReturn			= '~n'
sErrorcode 		= Left(sqlerrtext, 9)
iPos 		  		= Len(sqlerrtext) - Pos(sqlerrtext, "No changes made to database.", 1)
sErrorSyntax	= tRIM(Mid(sqlerrtext, 11, Len(sqlerrtext) - iPos - 11))

For iPos = Len(sErrorSyntax) to 1 STEP -1
	 sMsg = Mid(sErrorSyntax, ipos, 1)
	 If sMsg   = sReturn or sMsg = sNewline Then
		 iCount++
	 End if
Next

sErrorSynTax  	= Left(sErrorSyntax, Len(sErrorsyntax) - iCount)


str_db_error db_error_msg
db_error_msg.rowno 	 				= row
db_error_msg.errorcode 				= sErrorCode
db_error_msg.errorsyntax_system	= sErrorSyntax
db_error_msg.errorsyntax_user		= sErrorSyntax
db_error_msg.errorsqlsyntax			= sqlsyntax
OpenWithParm(w_error, db_error_msg)


/*sMsg = "Row No       -> " + String(row) 			 + '~n' + &
		 "Error Code   -> " + sErrorcode			    + '~n' + &
		 "Error Syntax -> " + sErrorSyntax			 + '~n' + &
		 "SqlSyntax    -> " + Sqlsyntax
	MESSAGEBOX("자료처리중 오류발생", sMsg) */

RETURN 1
end event

event editchanged;ib_any_typing = true
end event

event itemchanged;Int lRow,lReturnRow
string sorder, snull,sdate

SetNull(snull)

IF this.GetColumnName() = "yyyymm" THEN

	lRow  = this.GetRow()	
	
	sorder = trim(THIS.GETTEXT())

	if isnull(sorder) or sorder = "" then return 

	sdate = sorder + "01"
	IF f_datechk(sdate) = -1 THEN
		f_message_chk(35,'[년월]')
		this.SetItem(lrow,"yyyymm",snull)
		Return 1
	END IF

	lReturnRow = This.Find("yyyymm = '"+ sorder + "' ", 1, This.RowCount())
	
	IF (lRow <> lReturnRow) and (lReturnRow <> 0)		THEN
	
		f_message_chk(37,'[년월]') 
		
		this.SetItem(lRow, "yyyymm", sNull)
		
		RETURN  1
		
	END IF
END IF
end event

event itemerror;return 1
end event

type rr_12 from roundrectangle within tabpage_7
long linecolor = 28144969
integer linethickness = 1
long fillcolor = 32106727
integer x = 5
integer y = 16
integer width = 4178
integer height = 1368
integer cornerheight = 40
integer cornerwidth = 55
end type

type tabpage_9 from userobject within tab_1
integer x = 18
integer y = 176
integer width = 4421
integer height = 1468
long backcolor = 32106727
string text = "경영철학"
long tabbackcolor = 32106727
long picturemaskcolor = 536870912
dw_9 dw_9
st_1 st_1
end type

on tabpage_9.create
this.dw_9=create dw_9
this.st_1=create st_1
this.Control[]={this.dw_9,&
this.st_1}
end on

on tabpage_9.destroy
destroy(this.dw_9)
destroy(this.st_1)
end on

type dw_9 from datawindow within tabpage_9
integer x = 32
integer y = 80
integer width = 4361
integer height = 1112
integer taborder = 40
string dataobject = "d_pdm_01040_09"
boolean border = false
boolean livescroll = true
end type

event editchanged;ib_any_typing = true
end event

type st_1 from statictext within tabpage_9
integer x = 105
integer y = 64
integer width = 283
integer height = 56
boolean bringtotop = true
integer textsize = -10
integer weight = 700
fontcharset fontcharset = hangeul!
fontpitch fontpitch = fixed!
fontfamily fontfamily = modern!
string facename = "굴림체"
long textcolor = 134217856
long backcolor = 32106727
string text = "경영철학"
boolean focusrectangle = false
end type

type tabpage_11 from userobject within tab_1
integer x = 18
integer y = 176
integer width = 4421
integer height = 1468
long backcolor = 32106727
string text = "매출예상"
long tabbackcolor = 32106727
long picturemaskcolor = 536870912
p_11b p_11b
p_11a p_11a
dw_11 dw_11
rr_14 rr_14
end type

on tabpage_11.create
this.p_11b=create p_11b
this.p_11a=create p_11a
this.dw_11=create dw_11
this.rr_14=create rr_14
this.Control[]={this.p_11b,&
this.p_11a,&
this.dw_11,&
this.rr_14}
end on

on tabpage_11.destroy
destroy(this.p_11b)
destroy(this.p_11a)
destroy(this.dw_11)
destroy(this.rr_14)
end on

type p_11b from uo_picture within tabpage_11
integer x = 4210
integer y = 164
integer width = 178
string pointer = "c:\erpman\cur\delrow.cur"
string picturename = "C:\erpman\image\행삭제_up.gif"
end type

event clicked;call super::clicked;long 	curr_row

curr_row = tab_1.tabpage_11.dw_11.getrow()

if f_msg_delete() = -1 then return

if curr_row > 0  then
   tab_1.tabpage_11.dw_11.deleterow(curr_row)
	IF tab_1.tabpage_11.dw_11.Update() = 1 THEN
		COMMIT;
		
   	tab_1.tabpage_11.dw_11.setcolumn('mcyear')
   	tab_1.tabpage_11.dw_11.setfocus()
	ELSE
		ROLLBACK;
		RETURN
	END IF
end if


ib_any_typing = false
end event

type p_11a from uo_picture within tabpage_11
integer x = 4210
integer y = 24
integer width = 178
string pointer = "c:\erpman\cur\addrow.cur"
boolean originalsize = true
string picturename = "C:\erpman\image\행추가_up.gif"
end type

event clicked;call super::clicked;long curr_row, i
string scustno

if dw_ip.AcceptText() = -1 then return -1
if tab_1.tabpage_11.dw_11.AcceptText() = -1 then return -1

FOR i = 1 TO tab_1.tabpage_11.dw_11.RowCount()
	if isnull(tab_1.tabpage_11.dw_11.GetItemstring(i,'mcyear')) or &
		tab_1.tabpage_11.dw_11.GetItemString(i,'mcyear') = "" then
		f_message_chk(1400,'[ '+string(i)+' 행 년도]')
		tab_1.tabpage_11.dw_11.ScrollToRow(i)
		tab_1.tabpage_11.dw_11.SetColumn('mcyear')
		tab_1.tabpage_11.dw_11.SetFocus()
		return -1		
	end if	
NEXT

curr_row = tab_1.tabpage_11.dw_11.insertrow(0)

scustno = dw_ip.getitemstring(1, 'custno') 

tab_1.tabpage_11.dw_11.setitem(curr_row, "cust_no", scustno)

tab_1.tabpage_11.dw_11.setcolumn('mcyear')
tab_1.tabpage_11.dw_11.setrow(curr_row)
tab_1.tabpage_11.dw_11.scrolltorow(curr_row)

tab_1.tabpage_11.dw_11.setfocus()


end event

type dw_11 from datawindow within tabpage_11
event ue_presenter pbm_dwnprocessenter
integer x = 18
integer y = 24
integer width = 4151
integer height = 1348
integer taborder = 10
string dataobject = "d_pdm_01040_11"
boolean vscrollbar = true
boolean border = false
boolean livescroll = true
end type

event ue_presenter;Send( Handle(this), 256, 9, 0 )
Return 1


end event

event editchanged;ib_any_typing = true
end event

event dberror;String  sMsg, sErrorcode, sErrorsyntax, sReturn, sNewline
Integer iPos, iCount

iCount			= 0
sNewline			= '~r'
sReturn			= '~n'
sErrorcode 		= Left(sqlerrtext, 9)
iPos 		  		= Len(sqlerrtext) - Pos(sqlerrtext, "No changes made to database.", 1)
sErrorSyntax	= tRIM(Mid(sqlerrtext, 11, Len(sqlerrtext) - iPos - 11))

For iPos = Len(sErrorSyntax) to 1 STEP -1
	 sMsg = Mid(sErrorSyntax, ipos, 1)
	 If sMsg   = sReturn or sMsg = sNewline Then
		 iCount++
	 End if
Next

sErrorSynTax  	= Left(sErrorSyntax, Len(sErrorsyntax) - iCount)


str_db_error db_error_msg
db_error_msg.rowno 	 				= row
db_error_msg.errorcode 				= sErrorCode
db_error_msg.errorsyntax_system	= sErrorSyntax
db_error_msg.errorsyntax_user		= sErrorSyntax
db_error_msg.errorsqlsyntax			= sqlsyntax
OpenWithParm(w_error, db_error_msg)


/*sMsg = "Row No       -> " + String(row) 			 + '~n' + &
		 "Error Code   -> " + sErrorcode			    + '~n' + &
		 "Error Syntax -> " + sErrorSyntax			 + '~n' + &
		 "SqlSyntax    -> " + Sqlsyntax
	MESSAGEBOX("자료처리중 오류발생", sMsg) */

RETURN 1
end event

event itemchanged;Int lRow,lReturnRow
string sorder, snull

SetNull(snull)

IF this.GetColumnName() = "mcyear" THEN

	lRow  = this.GetRow()	
	
	sorder = trim(THIS.GETTEXT())
	
	if isnull(sorder) or sorder = "" then return 

	lReturnRow = This.Find("mcyear = '"+ sorder + "' ", 1, This.RowCount())
	
	IF (lRow <> lReturnRow) and (lReturnRow <> 0)		THEN
	
		f_message_chk(37,'[년도]') 
		
		this.SetItem(lRow, "mcyear", sNull)
		
		RETURN  1
		
	END IF
END IF
end event

event itemerror;return 1
end event

type rr_14 from roundrectangle within tabpage_11
long linecolor = 28144969
integer linethickness = 1
long fillcolor = 32106727
integer x = 5
integer y = 16
integer width = 4178
integer height = 1368
integer cornerheight = 40
integer cornerwidth = 55
end type

type tabpage_13 from userobject within tab_1
integer x = 18
integer y = 176
integer width = 4421
integer height = 1468
long backcolor = 32106727
string text = "평가도"
long tabbackcolor = 32106727
long picturemaskcolor = 536870912
p_13b p_13b
p_13a p_13a
dw_13 dw_13
rr_15 rr_15
end type

on tabpage_13.create
this.p_13b=create p_13b
this.p_13a=create p_13a
this.dw_13=create dw_13
this.rr_15=create rr_15
this.Control[]={this.p_13b,&
this.p_13a,&
this.dw_13,&
this.rr_15}
end on

on tabpage_13.destroy
destroy(this.p_13b)
destroy(this.p_13a)
destroy(this.dw_13)
destroy(this.rr_15)
end on

type p_13b from uo_picture within tabpage_13
integer x = 4219
integer y = 164
integer width = 178
string pointer = "c:\erpman\cur\delrow.cur"
string picturename = "C:\erpman\image\행삭제_up.gif"
end type

event clicked;call super::clicked;long 	curr_row

curr_row = tab_1.tabpage_13.dw_13.getrow()

if f_msg_delete() = -1 then return

if curr_row > 0  then
   tab_1.tabpage_13.dw_13.deleterow(curr_row)
	IF tab_1.tabpage_13.dw_13.Update() = 1 THEN
		COMMIT;
		
   	tab_1.tabpage_13.dw_13.setcolumn('pdate')
   	tab_1.tabpage_13.dw_13.setfocus()
	ELSE
		ROLLBACK;
		RETURN
	END IF
end if


ib_any_typing = false
end event

type p_13a from uo_picture within tabpage_13
integer x = 4219
integer y = 24
integer width = 178
string pointer = "c:\erpman\cur\addorw.cur"
string picturename = "C:\erpman\image\행추가_up.gif"
end type

event clicked;call super::clicked;long curr_row, i
string scustno

if dw_ip.AcceptText() = -1 then return -1
if tab_1.tabpage_13.dw_13.AcceptText() = -1 then return -1

FOR i = 1 TO tab_1.tabpage_13.dw_13.RowCount()
	if isnull(tab_1.tabpage_13.dw_13.GetItemstring(i,'pdate')) or &
		tab_1.tabpage_13.dw_13.GetItemString(i,'pdate') = "" then
		f_message_chk(1400,'[ '+string(i)+' 행 평가일]')
		tab_1.tabpage_13.dw_13.ScrollToRow(i)
		tab_1.tabpage_13.dw_13.SetColumn('pdate')
		tab_1.tabpage_13.dw_13.SetFocus()
		return -1		
	end if	
NEXT

curr_row = tab_1.tabpage_13.dw_13.insertrow(0)

scustno = dw_ip.getitemstring(1, 'custno') 

tab_1.tabpage_13.dw_13.setitem(curr_row, "cust_no", scustno)

tab_1.tabpage_13.dw_13.setcolumn('pdate')
tab_1.tabpage_13.dw_13.setrow(curr_row)
tab_1.tabpage_13.dw_13.scrolltorow(curr_row)

tab_1.tabpage_13.dw_13.setfocus()


end event

type dw_13 from datawindow within tabpage_13
event ue_presenter pbm_dwnprocessenter
integer x = 23
integer y = 24
integer width = 4146
integer height = 1340
integer taborder = 10
string dataobject = "d_pdm_01040_13"
boolean vscrollbar = true
boolean border = false
boolean livescroll = true
end type

event ue_presenter;IF this.GetColumnName() = 'psaf_rmks' or this.GetColumnName() = 'prsk_rmks'  THEN RETURN 

Send( Handle(this), 256, 9, 0 )
Return 1

end event

event itemerror;return 1
end event

event itemchanged;Int lRow,lReturnRow
string sorder, snull

SetNull(snull)

IF this.GetColumnName() = "pdate" THEN
	lRow  = this.GetRow()	
	sorder = trim(THIS.GETTEXT())

	if isnull(sorder) or sorder = "" then return 
	
	IF f_datechk(sorder) = -1 THEN
		f_message_chk(35,'[평가일]')
		this.SetItem(lrow,"pdate",snull)
		Return 1
	END IF
	lReturnRow = This.Find("pdate = '"+ sorder + "' ", 1, This.RowCount())
	IF (lRow <> lReturnRow) and (lReturnRow <> 0)		THEN
		f_message_chk(37,'[평가일]') 
		this.SetItem(lRow, "pdate", sNull)
		RETURN  1
	END IF
END IF
end event

event dberror;String  sMsg, sErrorcode, sErrorsyntax, sReturn, sNewline
Integer iPos, iCount

iCount			= 0
sNewline			= '~r'
sReturn			= '~n'
sErrorcode 		= Left(sqlerrtext, 9)
iPos 		  		= Len(sqlerrtext) - Pos(sqlerrtext, "No changes made to database.", 1)
sErrorSyntax	= tRIM(Mid(sqlerrtext, 11, Len(sqlerrtext) - iPos - 11))

For iPos = Len(sErrorSyntax) to 1 STEP -1
	 sMsg = Mid(sErrorSyntax, ipos, 1)
	 If sMsg   = sReturn or sMsg = sNewline Then
		 iCount++
	 End if
Next

sErrorSynTax  	= Left(sErrorSyntax, Len(sErrorsyntax) - iCount)


str_db_error db_error_msg
db_error_msg.rowno 	 				= row
db_error_msg.errorcode 				= sErrorCode
db_error_msg.errorsyntax_system	= sErrorSyntax
db_error_msg.errorsyntax_user		= sErrorSyntax
db_error_msg.errorsqlsyntax			= sqlsyntax
OpenWithParm(w_error, db_error_msg)


/*sMsg = "Row No       -> " + String(row) 			 + '~n' + &
		 "Error Code   -> " + sErrorcode			    + '~n' + &
		 "Error Syntax -> " + sErrorSyntax			 + '~n' + &
		 "SqlSyntax    -> " + Sqlsyntax
	MESSAGEBOX("자료처리중 오류발생", sMsg) */

RETURN 1
end event

event editchanged;ib_any_typing = true
end event

type rr_15 from roundrectangle within tabpage_13
long linecolor = 28144969
integer linethickness = 1
long fillcolor = 32106727
integer x = 5
integer y = 16
integer width = 4178
integer height = 1368
integer cornerheight = 40
integer cornerwidth = 55
end type

type tabpage_15 from userobject within tab_1
integer x = 18
integer y = 176
integer width = 4421
integer height = 1468
long backcolor = 32106727
string text = "특기사항"
long tabbackcolor = 32106727
long picturemaskcolor = 536870912
p_15b p_15b
p_15a p_15a
dw_15 dw_15
rr_16 rr_16
end type

on tabpage_15.create
this.p_15b=create p_15b
this.p_15a=create p_15a
this.dw_15=create dw_15
this.rr_16=create rr_16
this.Control[]={this.p_15b,&
this.p_15a,&
this.dw_15,&
this.rr_16}
end on

on tabpage_15.destroy
destroy(this.p_15b)
destroy(this.p_15a)
destroy(this.dw_15)
destroy(this.rr_16)
end on

type p_15b from uo_picture within tabpage_15
integer x = 4219
integer y = 164
integer width = 178
string pointer = "c:\erpman\cur\delrow.cur"
string picturename = "C:\erpman\image\행삭제_up.gif"
end type

event clicked;call super::clicked;long 	curr_row

curr_row = tab_1.tabpage_15.dw_15.getrow()

if f_msg_delete() = -1 then return

if curr_row > 0  then
   tab_1.tabpage_15.dw_15.deleterow(curr_row)
	IF tab_1.tabpage_15.dw_15.Update() = 1 THEN
		COMMIT;
		
   	tab_1.tabpage_15.dw_15.setcolumn('specialdate')
   	tab_1.tabpage_15.dw_15.setfocus()
	ELSE
		ROLLBACK;
		RETURN
	END IF
end if


ib_any_typing = false
end event

type p_15a from uo_picture within tabpage_15
integer x = 4219
integer y = 24
integer width = 178
string pointer = "c:\erpman\cur\addrow.cur"
string picturename = "C:\erpman\image\행추가_up.gif"
end type

event clicked;call super::clicked;long curr_row, i, lseq, maxseq
string scustno

if dw_ip.AcceptText() = -1 then return -1
if tab_1.tabpage_15.dw_15.AcceptText() = -1 then return -1

FOR i = 1 TO tab_1.tabpage_15.dw_15.RowCount()
	if isnull(tab_1.tabpage_15.dw_15.GetItemstring(i,'specialdate')) or &
		tab_1.tabpage_15.dw_15.GetItemString(i,'specialdate') = "" then
		f_message_chk(1400,'[ '+string(i)+' 행 접수일자]')
		tab_1.tabpage_15.dw_15.ScrollToRow(i)
		tab_1.tabpage_15.dw_15.SetColumn('specialdate')
		tab_1.tabpage_15.dw_15.SetFocus()
		return -1		
	end if	
NEXT

scustno = dw_ip.getitemstring(1, 'custno') 

FOR i=1 TO tab_1.tabpage_15.dw_15.Rowcount()
	maxseq = tab_1.tabpage_15.dw_15.getitemnumber(i, 'seq')
	if i = 1 then 
		lseq = maxseq
   else
		if lseq < maxseq then 
			lseq = maxseq
		end if	
   end if
NEXT

IF isnull(lseq) then lseq = 0 

lseq = lseq + 1

curr_row = tab_1.tabpage_15.dw_15.insertrow(0)

tab_1.tabpage_15.dw_15.setitem(curr_row, "cust_no", scustno)
tab_1.tabpage_15.dw_15.setitem(curr_row, "seq", lseq)

tab_1.tabpage_15.dw_15.setcolumn('specialdate')
tab_1.tabpage_15.dw_15.setrow(curr_row)
tab_1.tabpage_15.dw_15.scrolltorow(curr_row)

tab_1.tabpage_15.dw_15.setfocus()


end event

type dw_15 from datawindow within tabpage_15
event ue_key pbm_dwnkey
event ue_presenter pbm_dwnprocessenter
integer x = 18
integer y = 24
integer width = 4151
integer height = 1348
integer taborder = 10
string dataobject = "d_pdm_01040_15"
boolean vscrollbar = true
boolean border = false
boolean livescroll = true
end type

event ue_key;IF keydown(keyF1!) THEN
	TriggerEvent(RbuttonDown!)
END IF
end event

event ue_presenter;Send( Handle(this), 256, 9, 0 )
Return 1

end event

event itemchanged;string s_date, snull, sempno, sget_name
long   lrow

setnull(snull)

lRow  = this.GetRow()	

IF this.GetColumnName() = 'specialdate' THEN
	
	s_date = Trim(this.Gettext())
	IF s_date ="" OR IsNull(s_date) THEN RETURN
	
	IF f_datechk(s_date) = -1 THEN
		f_message_chk(35,'[접수일자]')
		this.SetItem(lrow,"specialdate",snull)
		this.Setcolumn("specialdate")
		this.SetFocus()
		Return 1
	END IF
ELSEIF this.GetColumnName() ="empid" THEN
	
	sempno = this.GetText()
	
	IF sempno ="" OR IsNull(sempno) THEN 
		this.SetItem(lrow,"p1_master_empname",snull)
		RETURN
	END IF
	
	SELECT "P1_MASTER"."EMPNAME"  
     INTO :sget_name  
     FROM "P1_MASTER"  
    WHERE ( "P1_MASTER"."EMPNO" = :sempno ) AND  
          ( "P1_MASTER"."SERVICEKINDCODE" <> '3' )   ;

	IF SQLCA.SQLCODE = 0 THEN
		this.SetItem(lrow,"p1_master_empname",sget_name)
	ELSE
		this.TriggerEvent(RbuttonDown!)
		IF gs_code ="" OR IsNull(gs_code) THEN
			this.SetItem(lrow,"empid",snull)
			this.SetItem(lrow,"p1_master_empname",snull)
		END IF
		
		Return 1	
	END IF
END IF
end event

event dberror;String  sMsg, sErrorcode, sErrorsyntax, sReturn, sNewline
Integer iPos, iCount

iCount			= 0
sNewline			= '~r'
sReturn			= '~n'
sErrorcode 		= Left(sqlerrtext, 9)
iPos 		  		= Len(sqlerrtext) - Pos(sqlerrtext, "No changes made to database.", 1)
sErrorSyntax	= tRIM(Mid(sqlerrtext, 11, Len(sqlerrtext) - iPos - 11))

For iPos = Len(sErrorSyntax) to 1 STEP -1
	 sMsg = Mid(sErrorSyntax, ipos, 1)
	 If sMsg   = sReturn or sMsg = sNewline Then
		 iCount++
	 End if
Next

sErrorSynTax  	= Left(sErrorSyntax, Len(sErrorsyntax) - iCount)


str_db_error db_error_msg
db_error_msg.rowno 	 				= row
db_error_msg.errorcode 				= sErrorCode
db_error_msg.errorsyntax_system	= sErrorSyntax
db_error_msg.errorsyntax_user		= sErrorSyntax
db_error_msg.errorsqlsyntax			= sqlsyntax
OpenWithParm(w_error, db_error_msg)


/*sMsg = "Row No       -> " + String(row) 			 + '~n' + &
		 "Error Code   -> " + sErrorcode			    + '~n' + &
		 "Error Syntax -> " + sErrorSyntax			 + '~n' + &
		 "SqlSyntax    -> " + Sqlsyntax
	MESSAGEBOX("자료처리중 오류발생", sMsg) */

RETURN 1
end event

event itemerror;return 1
end event

event editchanged;ib_any_typing = true
end event

event rbuttondown;long lrow

SetNull(Gs_code)
SetNull(Gs_codename)

IF  this.GetColumnName() = "empid" THEN
   lrow = this.getrow()
	
	Open(w_sawon_popup)

	IF isnull(gs_Code)  or  gs_Code = ''	then  return

	this.SetItem(lrow, "empid", gs_Code)
	this.SetItem(lrow, "p1_master_empname", gs_Codename)
END IF	

end event

type rr_16 from roundrectangle within tabpage_15
long linecolor = 28144969
integer linethickness = 1
long fillcolor = 32106727
integer x = 5
integer y = 16
integer width = 4178
integer height = 1368
integer cornerheight = 40
integer cornerwidth = 55
end type

type tabpage_2 from userobject within tab_1
integer x = 18
integer y = 176
integer width = 4421
integer height = 1468
long backcolor = 32106727
string text = "업체현황"
long tabbackcolor = 32106727
long picturemaskcolor = 536870912
p_21 p_21
dw_21 dw_21
cb_21 cb_21
dw_2 dw_2
rr_4 rr_4
end type

on tabpage_2.create
this.p_21=create p_21
this.dw_21=create dw_21
this.cb_21=create cb_21
this.dw_2=create dw_2
this.rr_4=create rr_4
this.Control[]={this.p_21,&
this.dw_21,&
this.cb_21,&
this.dw_2,&
this.rr_4}
end on

on tabpage_2.destroy
destroy(this.p_21)
destroy(this.dw_21)
destroy(this.cb_21)
destroy(this.dw_2)
destroy(this.rr_4)
end on

type p_21 from uo_picture within tabpage_2
integer x = 137
integer y = 1212
string pointer = "c:\erpman\cur\point.cur"
boolean originalsize = true
string picturename = "C:\erpman\image\인증마크등록_up.gif"
end type

event clicked;call super::clicked;dw_ip.accepttext()

str_cust.st_vndcod = dw_ip.getitemstring(1, 'vndcod')

SELECT "CUSTOMER"."CUST_NO"  
  INTO :str_cust.st_custno  
  FROM "CUSTOMER"  
 WHERE "CUSTOMER"."CVCOD" = :str_cust.st_vndcod   ;

openwithparm(w_pdm_01040_mark, str_cust)

tab_1.tabpage_2.dw_21.Retrieve(str_cust.st_vndcod) 


end event

type dw_21 from datawindow within tabpage_2
integer x = 626
integer y = 1240
integer width = 3685
integer height = 100
string dataobject = "d_pdm_01040_021"
boolean border = false
boolean livescroll = true
end type

type cb_21 from commandbutton within tabpage_2
integer x = 590
integer y = 1352
integer width = 457
integer height = 108
integer taborder = 30
integer textsize = -9
integer weight = 700
fontcharset fontcharset = hangeul!
fontpitch fontpitch = fixed!
fontfamily fontfamily = modern!
string facename = "굴림체"
string text = "인증마크 등록"
end type

type dw_2 from datawindow within tabpage_2
event ue_key pbm_dwnkey
event ue_presenter pbm_dwnprocessenter
integer x = 18
integer y = 24
integer width = 4402
integer height = 1148
integer taborder = 10
string dataobject = "d_pdm_01040_02"
boolean border = false
boolean livescroll = true
end type

event ue_key;IF keydown(keyF1!) THEN
	TriggerEvent(RbuttonDown!)
END IF
end event

event ue_presenter;Send( Handle(this), 256, 9, 0 )
Return 1
end event

event itemchanged;String sNull, s_date

setnull(snull)

IF this.GetColumnName() = 'cdate' THEN
	s_date = Trim(this.Gettext())
	IF s_date ="" OR IsNull(s_date) THEN RETURN
	
	IF f_datechk(s_date) = -1 THEN
		f_message_chk(35,'[창업일자]')
		this.SetItem(1,"cdate",snull)
		this.Setcolumn("cdate")
		this.SetFocus()
		Return 1
	END IF
ELSEIF this.GetColumnName() = 'crdat' THEN
	s_date = Trim(this.Gettext())
	IF s_date ="" OR IsNull(s_date) THEN RETURN
	
	IF f_datechk(s_date) = -1 THEN
		f_message_chk(35,'[영업개시일]')
		this.SetItem(1,"crdat",snull)
		this.Setcolumn("crdat")
		this.SetFocus()
		Return 1
	END IF
ELSEIF this.GetColumnName() = 'kdate' THEN
	s_date = Trim(this.Gettext())
	IF s_date ="" OR IsNull(s_date) THEN RETURN
	
	s_date = '1999' + s_date
	
	IF f_datechk(s_date) = -1 THEN
		f_message_chk(35,'[결산일자]')
		this.SetItem(1,"kdate",snull)
		this.Setcolumn("kdate")
		this.SetFocus()
		Return 1
	END IF
END IF	
end event

event itemerror;return 1
end event

type rr_4 from roundrectangle within tabpage_2
long linecolor = 28144969
integer linethickness = 1
long fillcolor = 33027312
integer x = 37
integer y = 1176
integer width = 4343
integer height = 240
integer cornerheight = 40
integer cornerwidth = 55
end type

type tabpage_4 from userobject within tab_1
integer x = 18
integer y = 176
integer width = 4421
integer height = 1468
long backcolor = 32106727
string text = "차입금"
long tabbackcolor = 32106727
long picturemaskcolor = 536870912
p_4b p_4b
p_4a p_4a
dw_4 dw_4
rr_17 rr_17
end type

on tabpage_4.create
this.p_4b=create p_4b
this.p_4a=create p_4a
this.dw_4=create dw_4
this.rr_17=create rr_17
this.Control[]={this.p_4b,&
this.p_4a,&
this.dw_4,&
this.rr_17}
end on

on tabpage_4.destroy
destroy(this.p_4b)
destroy(this.p_4a)
destroy(this.dw_4)
destroy(this.rr_17)
end on

type p_4b from uo_picture within tabpage_4
integer x = 4210
integer y = 164
integer width = 178
string pointer = "c:\erpman\cur\delrow.cur"
string picturename = "C:\erpman\image\행삭제_up.gif"
end type

event clicked;call super::clicked;long 	curr_row

curr_row = tab_1.tabpage_4.dw_4.getrow()

if f_msg_delete() = -1 then return

if curr_row > 0  then
   tab_1.tabpage_4.dw_4.deleterow(curr_row)
	IF tab_1.tabpage_4.dw_4.Update() = 1 THEN
		COMMIT;
		
   	tab_1.tabpage_4.dw_4.setcolumn('seq')
   	tab_1.tabpage_4.dw_4.setfocus()
	ELSE
		ROLLBACK;
		RETURN
	END IF
end if
ib_any_typing = false
end event

type p_4a from uo_picture within tabpage_4
integer x = 4210
integer y = 24
integer width = 178
string pointer = "c:\erpman\cur\addrow.cur"
string picturename = "C:\erpman\image\행추가_up.gif"
end type

event clicked;call super::clicked;long curr_row, i
string scustno

if dw_ip.AcceptText() = -1 then return -1
if tab_1.tabpage_4.dw_4.AcceptText() = -1 then return -1

FOR i = 1 TO tab_1.tabpage_4.dw_4.RowCount()
	if isnull(tab_1.tabpage_4.dw_4.GetItemNumber(i,'seq')) or &
		tab_1.tabpage_4.dw_4.GetItemNumber(i,'seq') = 0 then
		f_message_chk(1400,'[ '+string(i)+' 행 순번]')
		tab_1.tabpage_4.dw_4.ScrollToRow(i)
		tab_1.tabpage_4.dw_4.SetColumn('seq')
		tab_1.tabpage_4.dw_4.SetFocus()
		return -1		
	end if	
NEXT

curr_row = tab_1.tabpage_4.dw_4.insertrow(0)

scustno = dw_ip.getitemstring(1, 'custno') 

tab_1.tabpage_4.dw_4.setitem(curr_row, "cust_no", scustno)

tab_1.tabpage_4.dw_4.setcolumn('seq')
tab_1.tabpage_4.dw_4.setrow(curr_row)
tab_1.tabpage_4.dw_4.scrolltorow(curr_row)

tab_1.tabpage_4.dw_4.setfocus()


end event

type dw_4 from datawindow within tabpage_4
event ue_presenter pbm_dwnprocessenter
integer x = 18
integer y = 24
integer width = 4151
integer height = 1352
integer taborder = 20
string dataobject = "d_pdm_01040_04"
boolean vscrollbar = true
boolean border = false
boolean livescroll = true
end type

event ue_presenter;Send( Handle(this), 256, 9, 0 )
Return 1


end event

event itemchanged;Int lRow,lReturnRow, inull
string sorder

SetNull(inull)

IF this.GetColumnName() = "seq" THEN
	
	lRow  = this.GetRow()	
	
	sorder = THIS.GETTEXT()								
	
	if isnull(sorder) or sorder = "" then return 

	
	lReturnRow = This.Find("sorder = '"+ sorder + "' ", 1, This.RowCount())
	
	IF (lRow <> lReturnRow) and (lReturnRow <> 0)		THEN
	
		f_message_chk(37,'[순번]') 
		
		this.SetItem(lRow, "seq", iNull)
		
		RETURN  1
		
	END IF
END IF
end event

event itemerror;return 1
end event

event editchanged;ib_any_typing = true
end event

event dberror;String  sMsg, sErrorcode, sErrorsyntax, sReturn, sNewline
Integer iPos, iCount

iCount			= 0
sNewline			= '~r'
sReturn			= '~n'
sErrorcode 		= Left(sqlerrtext, 9)
iPos 		  		= Len(sqlerrtext) - Pos(sqlerrtext, "No changes made to database.", 1)
sErrorSyntax	= tRIM(Mid(sqlerrtext, 11, Len(sqlerrtext) - iPos - 11))

For iPos = Len(sErrorSyntax) to 1 STEP -1
	 sMsg = Mid(sErrorSyntax, ipos, 1)
	 If sMsg   = sReturn or sMsg = sNewline Then
		 iCount++
	 End if
Next

sErrorSynTax  	= Left(sErrorSyntax, Len(sErrorsyntax) - iCount)


str_db_error db_error_msg
db_error_msg.rowno 	 				= row
db_error_msg.errorcode 				= sErrorCode
db_error_msg.errorsyntax_system	= sErrorSyntax
db_error_msg.errorsyntax_user		= sErrorSyntax
db_error_msg.errorsqlsyntax			= sqlsyntax
OpenWithParm(w_error, db_error_msg)


/*sMsg = "Row No       -> " + String(row) 			 + '~n' + &
		 "Error Code   -> " + sErrorcode			    + '~n' + &
		 "Error Syntax -> " + sErrorSyntax			 + '~n' + &
		 "SqlSyntax    -> " + Sqlsyntax
	MESSAGEBOX("자료처리중 오류발생", sMsg) */

RETURN 1
end event

type rr_17 from roundrectangle within tabpage_4
long linecolor = 28144969
integer linethickness = 1
long fillcolor = 32106727
integer x = 5
integer y = 16
integer width = 4178
integer height = 1368
integer cornerheight = 40
integer cornerwidth = 55
end type

type tabpage_6 from userobject within tab_1
integer x = 18
integer y = 176
integer width = 4421
integer height = 1468
long backcolor = 32106727
string text = "주주명부"
long tabbackcolor = 32106727
long picturemaskcolor = 536870912
p_6b p_6b
p_6a p_6a
dw_6 dw_6
rr_18 rr_18
end type

on tabpage_6.create
this.p_6b=create p_6b
this.p_6a=create p_6a
this.dw_6=create dw_6
this.rr_18=create rr_18
this.Control[]={this.p_6b,&
this.p_6a,&
this.dw_6,&
this.rr_18}
end on

on tabpage_6.destroy
destroy(this.p_6b)
destroy(this.p_6a)
destroy(this.dw_6)
destroy(this.rr_18)
end on

type p_6b from uo_picture within tabpage_6
integer x = 4210
integer y = 164
integer width = 178
string pointer = "c:\erpman\cur\delrow.cur"
string picturename = "C:\erpman\image\행삭제_up.gif"
end type

event clicked;call super::clicked;long 	curr_row

curr_row =  tab_1.tabpage_6.dw_6.getrow()

if f_msg_delete() = -1 then return

if curr_row > 0  then
    tab_1.tabpage_6.dw_6.deleterow(curr_row)
	IF  tab_1.tabpage_6.dw_6.Update() = 1 THEN
		COMMIT;
		
   	 tab_1.tabpage_6.dw_6.setcolumn('seq')
   	 tab_1.tabpage_6.dw_6.setfocus()
	ELSE
		ROLLBACK;
		RETURN
	END IF
end if
ib_any_typing = false
end event

type p_6a from uo_picture within tabpage_6
integer x = 4210
integer y = 24
integer width = 178
string pointer = "c:\erpman\cur\addrow.cur"
string picturename = "C:\erpman\image\행추가_up.gif"
end type

event clicked;call super::clicked;long curr_row, i
string scustno

if dw_ip.AcceptText() = -1 then return -1
if tab_1.tabpage_6.dw_6.AcceptText() = -1 then return -1

FOR i = 1 TO tab_1.tabpage_6.dw_6.RowCount()
	if isnull(tab_1.tabpage_6.dw_6.GetItemNumber(i,'seq')) or &
		tab_1.tabpage_6.dw_6.GetItemNumber(i,'seq') = 0 then
		f_message_chk(1400,'[ '+string(i)+' 행 순번]')
		tab_1.tabpage_6.dw_6.ScrollToRow(i)
		tab_1.tabpage_6.dw_6.SetColumn('seq')
		tab_1.tabpage_6.dw_6.SetFocus()
		return -1		
	end if	
NEXT

curr_row = tab_1.tabpage_6.dw_6.insertrow(0)

scustno = dw_ip.getitemstring(1, 'custno') 

tab_1.tabpage_6.dw_6.setitem(curr_row, "cust_no", scustno)

tab_1.tabpage_6.dw_6.setcolumn('seq')
tab_1.tabpage_6.dw_6.setrow(curr_row)
tab_1.tabpage_6.dw_6.scrolltorow(curr_row)

tab_1.tabpage_6.dw_6.setfocus()


end event

type dw_6 from datawindow within tabpage_6
event ue_presenter pbm_dwnprocessenter
integer x = 27
integer y = 32
integer width = 4128
integer height = 1348
integer taborder = 10
string dataobject = "d_pdm_01040_06"
boolean vscrollbar = true
boolean border = false
boolean livescroll = true
end type

event ue_presenter;Send( Handle(this), 256, 9, 0 )
Return 1


end event

event dberror;String  sMsg, sErrorcode, sErrorsyntax, sReturn, sNewline
Integer iPos, iCount

iCount			= 0
sNewline			= '~r'
sReturn			= '~n'
sErrorcode 		= Left(sqlerrtext, 9)
iPos 		  		= Len(sqlerrtext) - Pos(sqlerrtext, "No changes made to database.", 1)
sErrorSyntax	= tRIM(Mid(sqlerrtext, 11, Len(sqlerrtext) - iPos - 11))

For iPos = Len(sErrorSyntax) to 1 STEP -1
	 sMsg = Mid(sErrorSyntax, ipos, 1)
	 If sMsg   = sReturn or sMsg = sNewline Then
		 iCount++
	 End if
Next

sErrorSynTax  	= Left(sErrorSyntax, Len(sErrorsyntax) - iCount)


str_db_error db_error_msg
db_error_msg.rowno 	 				= row
db_error_msg.errorcode 				= sErrorCode
db_error_msg.errorsyntax_system	= sErrorSyntax
db_error_msg.errorsyntax_user		= sErrorSyntax
db_error_msg.errorsqlsyntax			= sqlsyntax
OpenWithParm(w_error, db_error_msg)


/*sMsg = "Row No       -> " + String(row) 			 + '~n' + &
		 "Error Code   -> " + sErrorcode			    + '~n' + &
		 "Error Syntax -> " + sErrorSyntax			 + '~n' + &
		 "SqlSyntax    -> " + Sqlsyntax
	MESSAGEBOX("자료처리중 오류발생", sMsg) */

RETURN 1
end event

event editchanged;ib_any_typing = true
end event

event itemchanged;Int lRow,lReturnRow,  inull
string sorder

SetNull(inull)

IF this.GetColumnName() = "seq" THEN
	
	lRow  = this.GetRow()	
	
	sorder = THIS.GETTEXT()								

	if isnull(sorder) or sorder = "" then return 
	
	lReturnRow = This.Find("sorder = '"+ sorder + "' ", 1, This.RowCount())
	
	IF (lRow <> lReturnRow) and (lReturnRow <> 0)		THEN
	
		f_message_chk(37,'[순번]') 
		
		this.SetItem(lRow, "seq", iNull)
		
		RETURN  1
		
	END IF
END IF
end event

event itemerror;return 1
end event

type rr_18 from roundrectangle within tabpage_6
long linecolor = 28144969
integer linethickness = 1
long fillcolor = 32106727
integer x = 14
integer y = 24
integer width = 4160
integer height = 1368
integer cornerheight = 40
integer cornerwidth = 55
end type

type tabpage_8 from userobject within tab_1
integer x = 18
integer y = 176
integer width = 4421
integer height = 1468
long backcolor = 32106727
string text = "관련업체"
long tabbackcolor = 32106727
long picturemaskcolor = 536870912
p_8a p_8a
dw_8 dw_8
rr_19 rr_19
end type

on tabpage_8.create
this.p_8a=create p_8a
this.dw_8=create dw_8
this.rr_19=create rr_19
this.Control[]={this.p_8a,&
this.dw_8,&
this.rr_19}
end on

on tabpage_8.destroy
destroy(this.p_8a)
destroy(this.dw_8)
destroy(this.rr_19)
end on

type p_8a from uo_picture within tabpage_8
integer x = 4210
integer y = 24
integer width = 178
string pointer = "c:\erpman\cur\addrow.cur"
string picturename = "C:\erpman\image\행추가_up.gif"
end type

event clicked;call super::clicked;dw_ip.accepttext()

str_cust.st_vndcod = dw_ip.getitemstring(1, 'vndcod')

SELECT "CUSTOMER"."CUST_NO"  
  INTO :str_cust.st_custno  
  FROM "CUSTOMER"  
 WHERE "CUSTOMER"."CVCOD" = :str_cust.st_vndcod   ;

if sqlca.sqlcode <> 0 then 
	f_message_chk(41, '')
   return 
end if	

setnull(str_cust.st_tag)

openwithparm(w_pdm_01040_kvnd, str_cust)

tab_1.tabpage_8.dw_8.retrieve(str_cust.st_vndcod)


end event

type dw_8 from datawindow within tabpage_8
event ue_key pbm_dwnkey
event ue_pressenter pbm_dwnprocessenter
integer x = 23
integer y = 32
integer width = 4133
integer height = 1348
integer taborder = 10
string dataobject = "d_pdm_01040_08"
boolean vscrollbar = true
boolean border = false
boolean livescroll = true
end type

event clicked;If Row <= 0 then
	SelectRow(0,False)
ELSE
	SelectRow(0, FALSE)
	SelectRow(Row,TRUE)
END IF

end event

event doubleclicked;int    il_row

dw_ip.accepttext()

IF Row <= 0 THEN
   return
END IF

str_cust.st_vndcod = dw_ip.getitemstring(1, 'vndcod')

str_cust.st_custno = tab_1.tabpage_8.dw_8.GetItemString(Row, "cust_no")

str_cust.st_tag = tab_1.tabpage_8.dw_8.GetItemString(Row, "kwacod")

openwithparm(w_pdm_01040_kvnd, str_cust)

tab_1.tabpage_8.dw_8.retrieve(str_cust.st_vndcod)

end event

type rr_19 from roundrectangle within tabpage_8
long linecolor = 28144969
integer linethickness = 1
long fillcolor = 32106727
integer x = 14
integer y = 24
integer width = 4160
integer height = 1368
integer cornerheight = 40
integer cornerwidth = 55
end type

type tabpage_10 from userobject within tab_1
integer x = 18
integer y = 176
integer width = 4421
integer height = 1468
long backcolor = 32106727
string text = "경영목표"
long tabbackcolor = 32106727
long picturemaskcolor = 536870912
p_10b p_10b
p_10a p_10a
dw_10a dw_10a
dw_10 dw_10
rr_7 rr_7
end type

on tabpage_10.create
this.p_10b=create p_10b
this.p_10a=create p_10a
this.dw_10a=create dw_10a
this.dw_10=create dw_10
this.rr_7=create rr_7
this.Control[]={this.p_10b,&
this.p_10a,&
this.dw_10a,&
this.dw_10,&
this.rr_7}
end on

on tabpage_10.destroy
destroy(this.p_10b)
destroy(this.p_10a)
destroy(this.dw_10a)
destroy(this.dw_10)
destroy(this.rr_7)
end on

type p_10b from uo_picture within tabpage_10
integer x = 4210
integer y = 440
integer width = 178
string pointer = "c:\erpman\cur\delrow.cur"
string picturename = "C:\erpman\image\행삭제_up.gif"
end type

event clicked;call super::clicked;long 	curr_row

curr_row = tab_1.tabpage_10.dw_10a.getrow()

if f_msg_delete() = -1 then return

if curr_row > 0  then
   tab_1.tabpage_10.dw_10a.deleterow(curr_row)
	IF tab_1.tabpage_10.dw_10a.Update() = 1 THEN
		COMMIT;
		
   	tab_1.tabpage_10.dw_10a.setcolumn('mtgyear')
   	tab_1.tabpage_10.dw_10a.setfocus()
	ELSE
		ROLLBACK;
		RETURN
	END IF
end if


ib_any_typing = false
end event

type p_10a from uo_picture within tabpage_10
integer x = 4210
integer y = 300
integer width = 178
string pointer = "c:\erpman\cur\addrow.cur"
string picturename = "C:\erpman\image\행추가_up.gif"
end type

event clicked;call super::clicked;long curr_row, i
string scustno

if dw_ip.AcceptText() = -1 then return -1
if tab_1.tabpage_10.dw_10a.AcceptText() = -1 then return -1

FOR i = 1 TO tab_1.tabpage_10.dw_10a.RowCount()
	if isnull(tab_1.tabpage_10.dw_10a.GetItemstring(i,'mtgyear')) or &
		tab_1.tabpage_10.dw_10a.GetItemString(i,'mtgyear') = "" then
		f_message_chk(1400,'[ '+string(i)+' 행 년도]')
		tab_1.tabpage_10.dw_10a.ScrollToRow(i)
		tab_1.tabpage_10.dw_10a.SetColumn('mtgyear')
		tab_1.tabpage_10.dw_10a.SetFocus()
		return -1		
	end if	
NEXT

curr_row = tab_1.tabpage_10.dw_10a.insertrow(0)

scustno = dw_ip.getitemstring(1, 'custno') 

tab_1.tabpage_10.dw_10a.setitem(curr_row, "cust_no", scustno)

tab_1.tabpage_10.dw_10a.setcolumn('mtgyear')
tab_1.tabpage_10.dw_10a.setrow(curr_row)
tab_1.tabpage_10.dw_10a.scrolltorow(curr_row)

tab_1.tabpage_10.dw_10a.setfocus()


end event

type dw_10a from datawindow within tabpage_10
event ue_presenter pbm_dwnprocessenter
integer x = 69
integer y = 320
integer width = 4101
integer height = 1092
integer taborder = 20
string dataobject = "d_pdm_01040_10_1"
boolean vscrollbar = true
boolean border = false
boolean livescroll = true
end type

event ue_presenter;Send( Handle(this), 256, 9, 0 )
Return 1


end event

event dberror;String  sMsg, sErrorcode, sErrorsyntax, sReturn, sNewline
Integer iPos, iCount

iCount			= 0
sNewline			= '~r'
sReturn			= '~n'
sErrorcode 		= Left(sqlerrtext, 9)
iPos 		  		= Len(sqlerrtext) - Pos(sqlerrtext, "No changes made to database.", 1)
sErrorSyntax	= tRIM(Mid(sqlerrtext, 11, Len(sqlerrtext) - iPos - 11))

For iPos = Len(sErrorSyntax) to 1 STEP -1
	 sMsg = Mid(sErrorSyntax, ipos, 1)
	 If sMsg   = sReturn or sMsg = sNewline Then
		 iCount++
	 End if
Next

sErrorSynTax  	= Left(sErrorSyntax, Len(sErrorsyntax) - iCount)


str_db_error db_error_msg
db_error_msg.rowno 	 				= row
db_error_msg.errorcode 				= sErrorCode
db_error_msg.errorsyntax_system	= sErrorSyntax
db_error_msg.errorsyntax_user		= sErrorSyntax
db_error_msg.errorsqlsyntax			= sqlsyntax
OpenWithParm(w_error, db_error_msg)


/*sMsg = "Row No       -> " + String(row) 			 + '~n' + &
		 "Error Code   -> " + sErrorcode			    + '~n' + &
		 "Error Syntax -> " + sErrorSyntax			 + '~n' + &
		 "SqlSyntax    -> " + Sqlsyntax
	MESSAGEBOX("자료처리중 오류발생", sMsg) */

RETURN 1
end event

event editchanged;ib_any_typing = true
end event

event itemchanged;Int lRow,lReturnRow
string sorder, snull

SetNull(snull)

IF this.GetColumnName() = "mtgyear" THEN

	lRow  = this.GetRow()	
	
	sorder = trim(THIS.GETTEXT())
	
	if isnull(sorder) or sorder = "" then return 

	lReturnRow = This.Find("mtgyear = '"+ sorder + "' ", 1, This.RowCount())
	
	IF (lRow <> lReturnRow) and (lReturnRow <> 0)		THEN
	
		f_message_chk(37,'[년도]') 
		
		this.SetItem(lRow, "mtgyear", sNull)
		
		RETURN  1
		
	END IF
END IF
end event

event itemerror;return 1
end event

type dw_10 from datawindow within tabpage_10
event ue_presenter pbm_dwnprocessenter
integer x = 37
integer y = 16
integer width = 2341
integer height = 292
integer taborder = 10
string dataobject = "d_pdm_01040_10"
boolean border = false
boolean livescroll = true
end type

event ue_presenter;Send( Handle(this), 256, 9, 0 )
Return 1


end event

event editchanged;ib_any_typing = true
end event

type rr_7 from roundrectangle within tabpage_10
long linecolor = 28144969
integer linethickness = 1
long fillcolor = 32106727
integer x = 50
integer y = 308
integer width = 4133
integer height = 1116
integer cornerheight = 40
integer cornerwidth = 55
end type

type tabpage_12 from userobject within tab_1
integer x = 18
integer y = 176
integer width = 4421
integer height = 1468
long backcolor = 32106727
string text = "주변의견"
long tabbackcolor = 32106727
long picturemaskcolor = 536870912
p_12b p_12b
p_12a p_12a
dw_12 dw_12
rr_20 rr_20
end type

on tabpage_12.create
this.p_12b=create p_12b
this.p_12a=create p_12a
this.dw_12=create dw_12
this.rr_20=create rr_20
this.Control[]={this.p_12b,&
this.p_12a,&
this.dw_12,&
this.rr_20}
end on

on tabpage_12.destroy
destroy(this.p_12b)
destroy(this.p_12a)
destroy(this.dw_12)
destroy(this.rr_20)
end on

type p_12b from uo_picture within tabpage_12
integer x = 4215
integer y = 164
integer width = 178
string pointer = "c:\erpman\cur\delrow.cur"
string picturename = "C:\erpman\image\행삭제_up.gif"
end type

event clicked;call super::clicked;long 	curr_row

curr_row = tab_1.tabpage_12.dw_12.getrow()

if f_msg_delete() = -1 then return

if curr_row > 0  then
   tab_1.tabpage_12.dw_12.deleterow(curr_row)
	IF tab_1.tabpage_12.dw_12.Update() = 1 THEN
		COMMIT;
		
   	tab_1.tabpage_12.dw_12.setcolumn('acdate')
   	tab_1.tabpage_12.dw_12.setfocus()
	ELSE
		ROLLBACK;
		RETURN
	END IF
end if


ib_any_typing = false
end event

type p_12a from uo_picture within tabpage_12
integer x = 4215
integer y = 24
integer width = 178
string pointer = "c:\erpman\cur\addrow.cur"
string picturename = "C:\erpman\image\행추가_up.gif"
end type

event clicked;call super::clicked;long curr_row, i, lseq, maxseq
string scustno

if dw_ip.AcceptText() = -1 then return -1
if tab_1.tabpage_12.dw_12.AcceptText() = -1 then return -1

FOR i = 1 TO tab_1.tabpage_12.dw_12.RowCount()
	if isnull(tab_1.tabpage_12.dw_12.GetItemstring(i,'acdate')) or &
		tab_1.tabpage_12.dw_12.GetItemString(i,'acdate') = "" then
		f_message_chk(1400,'[ '+string(i)+' 행 정보접수일]')
		tab_1.tabpage_12.dw_12.ScrollToRow(i)
		tab_1.tabpage_12.dw_12.SetColumn('acdate')
		tab_1.tabpage_12.dw_12.SetFocus()
		return -1		
	end if	
NEXT

scustno = dw_ip.getitemstring(1, 'custno') 

FOR i=1 TO tab_1.tabpage_12.dw_12.Rowcount()
	maxseq = tab_1.tabpage_12.dw_12.getitemnumber(i, 'seq')
	if i = 1 then 
		lseq = maxseq
   else
		if lseq < maxseq then 
			lseq = maxseq
		end if	
   end if
NEXT

IF isnull(lseq) then lseq = 0 

lseq = lseq + 1

curr_row = tab_1.tabpage_12.dw_12.insertrow(0)

tab_1.tabpage_12.dw_12.setitem(curr_row, "cust_no", scustno)
tab_1.tabpage_12.dw_12.setitem(curr_row, "seq", lseq)

tab_1.tabpage_12.dw_12.setcolumn('acdate')
tab_1.tabpage_12.dw_12.setrow(curr_row)
tab_1.tabpage_12.dw_12.scrolltorow(curr_row)

tab_1.tabpage_12.dw_12.setfocus()


end event

type dw_12 from datawindow within tabpage_12
event ue_presenter pbm_dwnprocessenter
integer x = 14
integer y = 20
integer width = 4151
integer height = 1356
integer taborder = 10
string dataobject = "d_pdm_01040_12"
boolean vscrollbar = true
boolean border = false
boolean livescroll = true
end type

event ue_presenter;IF this.GetColumnName() = 'bigo' THEN RETURN 

Send( Handle(this), 256, 9, 0 )
Return 1

end event

event dberror;String  sMsg, sErrorcode, sErrorsyntax, sReturn, sNewline
Integer iPos, iCount

iCount			= 0
sNewline			= '~r'
sReturn			= '~n'
sErrorcode 		= Left(sqlerrtext, 9)
iPos 		  		= Len(sqlerrtext) - Pos(sqlerrtext, "No changes made to database.", 1)
sErrorSyntax	= tRIM(Mid(sqlerrtext, 11, Len(sqlerrtext) - iPos - 11))

For iPos = Len(sErrorSyntax) to 1 STEP -1
	 sMsg = Mid(sErrorSyntax, ipos, 1)
	 If sMsg   = sReturn or sMsg = sNewline Then
		 iCount++
	 End if
Next

sErrorSynTax  	= Left(sErrorSyntax, Len(sErrorsyntax) - iCount)


str_db_error db_error_msg
db_error_msg.rowno 	 				= row
db_error_msg.errorcode 				= sErrorCode
db_error_msg.errorsyntax_system	= sErrorSyntax
db_error_msg.errorsyntax_user		= sErrorSyntax
db_error_msg.errorsqlsyntax			= sqlsyntax
OpenWithParm(w_error, db_error_msg)


/*sMsg = "Row No       -> " + String(row) 			 + '~n' + &
		 "Error Code   -> " + sErrorcode			    + '~n' + &
		 "Error Syntax -> " + sErrorSyntax			 + '~n' + &
		 "SqlSyntax    -> " + Sqlsyntax
	MESSAGEBOX("자료처리중 오류발생", sMsg) */

RETURN 1
end event

event editchanged;ib_any_typing = true
end event

event itemchanged;string s_date, snull
long lrow

setnull(snull)

IF this.GetColumnName() = 'acdate' THEN
	lRow  = this.GetRow()	
	s_date = Trim(this.Gettext())
	IF s_date ="" OR IsNull(s_date) THEN RETURN
	
	IF f_datechk(s_date) = -1 THEN
		f_message_chk(35,'[정보접수일]')
		this.SetItem(lrow,"acdate",snull)
		this.Setcolumn("acdate")
		this.SetFocus()
		Return 1
	END IF
END IF
end event

event itemerror;RETURN 1
end event

type rr_20 from roundrectangle within tabpage_12
long linecolor = 28144969
integer linethickness = 1
long fillcolor = 32106727
integer x = 5
integer y = 16
integer width = 4178
integer height = 1368
integer cornerheight = 40
integer cornerwidth = 55
end type

type tabpage_14 from userobject within tab_1
integer x = 18
integer y = 176
integer width = 4421
integer height = 1468
long backcolor = 32106727
string text = "종합평가"
long tabbackcolor = 32106727
long picturemaskcolor = 536870912
p_14b p_14b
p_14a p_14a
dw_14 dw_14
rr_21 rr_21
end type

on tabpage_14.create
this.p_14b=create p_14b
this.p_14a=create p_14a
this.dw_14=create dw_14
this.rr_21=create rr_21
this.Control[]={this.p_14b,&
this.p_14a,&
this.dw_14,&
this.rr_21}
end on

on tabpage_14.destroy
destroy(this.p_14b)
destroy(this.p_14a)
destroy(this.dw_14)
destroy(this.rr_21)
end on

type p_14b from uo_picture within tabpage_14
integer x = 4215
integer y = 164
integer width = 178
string pointer = "c:\erpman\cur\delrow.cur"
string picturename = "C:\erpman\image\행삭제_up.gif"
end type

event clicked;call super::clicked;long 	curr_row

curr_row = tab_1.tabpage_14.dw_14.getrow()

if f_msg_delete() = -1 then return

if curr_row > 0  then
   tab_1.tabpage_14.dw_14.deleterow(curr_row)
	IF tab_1.tabpage_14.dw_14.Update() = 1 THEN
		COMMIT;
		
   	tab_1.tabpage_14.dw_14.setcolumn('tdate')
   	tab_1.tabpage_14.dw_14.setfocus()
	ELSE
		ROLLBACK;
		RETURN
	END IF
end if


ib_any_typing = false
end event

type p_14a from uo_picture within tabpage_14
integer x = 4215
integer y = 24
integer width = 178
string pointer = "c:\erpman\cur\addrow.cur"
string picturename = "C:\erpman\image\행추가_up.gif"
end type

event clicked;call super::clicked;long curr_row, i
string scustno

if dw_ip.AcceptText() = -1 then return -1
if tab_1.tabpage_14.dw_14.AcceptText() = -1 then return -1

FOR i = 1 TO tab_1.tabpage_14.dw_14.RowCount()
	if isnull(tab_1.tabpage_14.dw_14.GetItemstring(i,'tdate')) or &
		tab_1.tabpage_14.dw_14.GetItemString(i,'tdate') = "" then
		f_message_chk(1400,'[ '+string(i)+' 행 종합평가일]')
		tab_1.tabpage_14.dw_14.ScrollToRow(i)
		tab_1.tabpage_14.dw_14.SetColumn('tdate')
		tab_1.tabpage_14.dw_14.SetFocus()
		return -1		
	end if	
NEXT

curr_row = tab_1.tabpage_14.dw_14.insertrow(0)

scustno = dw_ip.getitemstring(1, 'custno') 

tab_1.tabpage_14.dw_14.setitem(curr_row, "cust_no", scustno)

tab_1.tabpage_14.dw_14.setcolumn('tdate')
tab_1.tabpage_14.dw_14.setrow(curr_row)
tab_1.tabpage_14.dw_14.scrolltorow(curr_row)

tab_1.tabpage_14.dw_14.setfocus()


end event

type dw_14 from datawindow within tabpage_14
event ue_presenter pbm_dwnprocessenter
integer x = 14
integer y = 24
integer width = 4155
integer height = 1348
integer taborder = 1
string dataobject = "d_pdm_01040_14"
boolean vscrollbar = true
boolean border = false
boolean livescroll = true
end type

event ue_presenter;IF this.GetColumnName() = 'topy' or this.GetColumnName() = 'toda' or &
   this.GetColumnName() = 'toba' or this.GetColumnName() = 'tokw' THEN RETURN 

Send( Handle(this), 256, 9, 0 )
Return 1

end event

event itemchanged;Int lRow,lReturnRow
string sorder, snull

SetNull(snull)

IF this.GetColumnName() = "tdate" THEN
	lRow  = this.GetRow()	
	sorder = trim(THIS.GETTEXT())

	if isnull(sorder) or sorder = "" then return 
	
	IF f_datechk(sorder) = -1 THEN
		f_message_chk(35,'[종합평가일]')
		this.SetItem(lrow,"tdate",snull)
		Return 1
	END IF
	lReturnRow = This.Find("tdate = '"+ sorder + "' ", 1, This.RowCount())
	IF (lRow <> lReturnRow) and (lReturnRow <> 0)		THEN
		f_message_chk(37,'[종합평가일]') 
		this.SetItem(lRow, "tdate", sNull)
		RETURN  1
	END IF
END IF
end event

event itemerror;return 1
end event

event dberror;String  sMsg, sErrorcode, sErrorsyntax, sReturn, sNewline
Integer iPos, iCount

iCount			= 0
sNewline			= '~r'
sReturn			= '~n'
sErrorcode 		= Left(sqlerrtext, 9)
iPos 		  		= Len(sqlerrtext) - Pos(sqlerrtext, "No changes made to database.", 1)
sErrorSyntax	= tRIM(Mid(sqlerrtext, 11, Len(sqlerrtext) - iPos - 11))

For iPos = Len(sErrorSyntax) to 1 STEP -1
	 sMsg = Mid(sErrorSyntax, ipos, 1)
	 If sMsg   = sReturn or sMsg = sNewline Then
		 iCount++
	 End if
Next

sErrorSynTax  	= Left(sErrorSyntax, Len(sErrorsyntax) - iCount)


str_db_error db_error_msg
db_error_msg.rowno 	 				= row
db_error_msg.errorcode 				= sErrorCode
db_error_msg.errorsyntax_system	= sErrorSyntax
db_error_msg.errorsyntax_user		= sErrorSyntax
db_error_msg.errorsqlsyntax			= sqlsyntax
OpenWithParm(w_error, db_error_msg)


/*sMsg = "Row No       -> " + String(row) 			 + '~n' + &
		 "Error Code   -> " + sErrorcode			    + '~n' + &
		 "Error Syntax -> " + sErrorSyntax			 + '~n' + &
		 "SqlSyntax    -> " + Sqlsyntax
	MESSAGEBOX("자료처리중 오류발생", sMsg) */

RETURN 1
end event

event editchanged;ib_any_typing = true
end event

type rr_21 from roundrectangle within tabpage_14
long linecolor = 28144969
integer linethickness = 1
long fillcolor = 32106727
integer x = 5
integer y = 16
integer width = 4178
integer height = 1368
integer cornerheight = 40
integer cornerwidth = 55
end type

type tabpage_16 from userobject within tab_1
integer x = 18
integer y = 176
integer width = 4421
integer height = 1468
long backcolor = 32106727
string text = "애로 및 요청"
long tabbackcolor = 32106727
long picturemaskcolor = 536870912
p_16a p_16a
dw_16 dw_16
rr_22 rr_22
end type

on tabpage_16.create
this.p_16a=create p_16a
this.dw_16=create dw_16
this.rr_22=create rr_22
this.Control[]={this.p_16a,&
this.dw_16,&
this.rr_22}
end on

on tabpage_16.destroy
destroy(this.p_16a)
destroy(this.dw_16)
destroy(this.rr_22)
end on

type p_16a from uo_picture within tabpage_16
integer x = 4215
integer y = 24
integer width = 178
string pointer = "c:\erpman\cur\addrow.cur"
string picturename = "C:\erpman\image\행추가_up.gif"
end type

event clicked;call super::clicked;dw_ip.accepttext()

str_cust.st_vndcod = dw_ip.getitemstring(1, 'vndcod')

SELECT "CUSTOMER"."CUST_NO"  
  INTO :str_cust.st_custno  
  FROM "CUSTOMER"  
 WHERE "CUSTOMER"."CVCOD" = :str_cust.st_vndcod   ;

if sqlca.sqlcode <> 0 then 
	f_message_chk(41, '')
   return 
else
	SELECT MAX("CUSTASLST"."SEQ")  
     INTO :str_cust.st_seq    
     FROM "CUSTASLST"  
    WHERE "CUSTASLST"."CUST_NO" = :str_cust.st_custno   ;
end if	

if isnull(str_cust.st_seq) then str_cust.st_seq = 0 

str_cust.st_seq = str_cust.st_seq + 1

openwithparm(w_pdm_01040_as, str_cust)

tab_1.tabpage_16.dw_16.retrieve(str_cust.st_vndcod)


end event

type dw_16 from datawindow within tabpage_16
integer x = 18
integer y = 24
integer width = 4146
integer height = 1348
integer taborder = 1
string dataobject = "d_pdm_01040_16"
boolean vscrollbar = true
boolean border = false
boolean livescroll = true
end type

event clicked;If Row <= 0 then
	SelectRow(0,False)
ELSE
	SelectRow(0, FALSE)
	SelectRow(Row,TRUE)
END IF

end event

event doubleclicked;dw_ip.accepttext()

IF Row <= 0 THEN
   return
END IF

str_cust.st_vndcod = dw_ip.getitemstring(1, 'vndcod')

str_cust.st_custno = this.GetItemString(Row, "cust_no")

str_cust.st_seq = this.GetItemNumber(Row, "seq")

openwithparm(w_pdm_01040_as, str_cust)

this.retrieve(str_cust.st_vndcod)

end event

type rr_22 from roundrectangle within tabpage_16
long linecolor = 28144969
integer linethickness = 1
long fillcolor = 32106727
integer x = 5
integer y = 16
integer width = 4178
integer height = 1368
integer cornerheight = 40
integer cornerwidth = 55
end type

